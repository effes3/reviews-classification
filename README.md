---
jupyter:
  accelerator: GPU
  colab:
    gpuType: T4
  kernelspec:
    display_name: Python 3
    name: python3
  language_info:
    name: python
  nbformat: 4
  nbformat_minor: 0
  widgets:
    application/vnd.jupyter.widget-state+json:
      0020cc28ae584c33b30279db6d93e3ac:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      008b664059424c97b0e5d5492e3cbdfb:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_5f8ba7b861fa4611981defd4ee46ca8f
          placeholder: ​
          style: IPY_MODEL_d1ba5e5346d94920bb17fecff7b8a0e2
          value: "sentencepiece.bpe.model: 100%"
      01e7d116e0ea4283b3207b2f71da1f7c:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      0315765bb52e4924a9be49d4e44d367d:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      043c8a5b36644ed989b61aaee03794b9:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_9ecac5858dca4d99abc090bf6fc76800
          placeholder: ​
          style: IPY_MODEL_ce590e850b2b4771b716039ec731b853
          value: "Generating validation split: "
      07692bff93684717ac1319f627553b9d:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_7321fd3876994b0db7e8581bf0844b58
          placeholder: ​
          style: IPY_MODEL_944d7d60b5b34fa98fb69baba931ff8b
          value: " 112/112 \\[00:00&lt;00:00, 2.50kB/s\\]"
      096a2cc9ea7c4f7b805e6fa209c800b8:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      0b45604901f0407887ec290a69dde87d:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_40d306006f9841e39b95eef6e6c7d2e5
          max: 711456784
          min: 0
          orientation: horizontal
          style: IPY_MODEL_a656bf0fec4c4ac8b0a1baca9b516e1e
          value: 711456784
      0b82a4ee13024df5ad273bc7c383b5e3:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_91ad9db5e34c494e978a95453f34fb4b
          placeholder: ​
          style: IPY_MODEL_a594c57e99ab41a49e365eb542702bbc
          value: " 2.24G/2.24G \\[00:33&lt;00:00, 133MB/s\\]"
      0baebae27d844995baf9b6ba5f45a689:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      0d10bfc6078547f580a8d078ec69f817:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      0f9cef7c697d487c82d5ed2d57c08432:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_6a37b354666a4548a09a6cacad71b52e
          max: 642
          min: 0
          orientation: horizontal
          style: IPY_MODEL_3c952e7619f34e59b4cf1b016fb7fd9e
          value: 642
      11cab298fa6c45a18bed1f1502b6212a:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: PasswordModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: PasswordModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: PasswordView
          continuous_update: true
          description: "Token:"
          disabled: false
          layout: IPY_MODEL_0baebae27d844995baf9b6ba5f45a689
          placeholder: ​
          style: IPY_MODEL_919690191da0461b8302d3bbea99f445
      143362d404c449f7b130860c59ddcfdf:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      158c5b34728f49d5b5c38d5c39344b31:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      15d76178b9ae41f2845f4c321a661f71:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      168996ecb9124b67b991fb07f9f823e0:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      16d209443db542308bdc10e012128799:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_dfc7455d960e4528a99505807a2ac149
          max: 24
          min: 0
          orientation: horizontal
          style: IPY_MODEL_79f7df086bdf44868fdee2441309c874
          value: 24
      1880c60e7fd44b339cb8f5288d8cbbcb:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      18b7b98e6e9e488a8f2324acfa1dc2ec:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_a2bcf202747d49d9bf7edc1804939892
          max: 711436136
          min: 0
          orientation: horizontal
          style: IPY_MODEL_bf666b6b8eab4618aaa834c27fc9388a
          value: 711436136
      18b8ffaac83e457eab6a37f397611bbe:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      19972986023746cd82d5d5a704f0dc03:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      19cf0daa9ca040489a50e859f993a604:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_88c8bdd9445e4f1d86f5b77240d0b4cb
          placeholder: ​
          style: IPY_MODEL_3f16382a00044f90b8b265c15590bba5
          value: "vocab.txt: "
      19e5313893d247d79e33ab10dbd36bdc:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_d3155521625d456e9438067b8a6ee241
          placeholder: ​
          style: IPY_MODEL_80aa53fe361840d89c7389dea2f211e9
          value: " 642/642 \\[00:00&lt;00:00, 33.0kB/s\\]"
      19fe740fec3844a6b309c24ee2946f6d:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      1bad8e754f0b4f039cbe976ed5b3b66a:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_b128d973246947899a8a15c118cd7b29
          placeholder: ​
          style: IPY_MODEL_612f4d893d294e249309eb4142958b44
          value: "pytorch_model.bin: 100%"
      1df990856aa64a258655fed9771acb07:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_92e8122b2f0e4c7bb5b12129beb292b0
          placeholder: ​
          style: IPY_MODEL_290969b5faed42c1ba9afcb3878d9d21
          value: " 711M/711M \\[00:09&lt;00:00, 123MB/s\\]"
      1f5cf6cd71b749c689682a8d7049074c:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      22ccf54fea804197bcecc1e1ebcfac24:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      2433c81a283f4d5991d895678eb4aed2:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_9a0666df5d5746b1a7a3087bdde74fec
          max: 7276
          min: 0
          orientation: horizontal
          style: IPY_MODEL_a4871ff125884d079879ff6bbac9d67e
          value: 7276
      2586a33ed6ed42dc84d9af4a07efb276:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_043c8a5b36644ed989b61aaee03794b9
          - IPY_MODEL_6bef76c6ee614a66bdfbac9405125638
          - IPY_MODEL_5b4754e60dfd41a696046111c1bee5e9
          layout: IPY_MODEL_2d25ec8493dc4aec844bc89397950b18
      25e5974b6216436fb8b3bfde2d9847b2:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_ac43528ff7d043df93e3a528ad346935
          placeholder: ​
          style: IPY_MODEL_cade815c501d472980533c05e09f444e
          value: " 384/384 \\[00:00&lt;00:00, 1645.71 examples/s\\]"
      2721df7509ab45e29e3985118a1f4e98:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      290969b5faed42c1ba9afcb3878d9d21:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      29112341dd5a4c9e81a8cebcd78b1fdb:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      2a2afff6f3344fd686e4f47484cde10b:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      2ad31e03da334b41bb278d8236105a89:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      2b5845514d954a3383aee467a05cfa1d:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      2d25ec8493dc4aec844bc89397950b18:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      2dde06f1d3b144a09e936c04d5de4f48:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      2e6b484ce9474b188daeb2724724a00f:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_80f5e32430434d8da997d9d883e956d4
          - IPY_MODEL_2433c81a283f4d5991d895678eb4aed2
          - IPY_MODEL_af245cff633249f0a4d4b711df220205
          layout: IPY_MODEL_2b5845514d954a3383aee467a05cfa1d
      2ece6ea27e904cf3b9c9ecdb2e827941:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_3eecbd4f17ed4241b4dcd6812171ce4a
          placeholder: ​
          style: IPY_MODEL_56adc9cf06db4e019b3b2f98610b507b
          value: "Map: 100%"
      2f0b973a5146492ebeb5c1c9432098d9:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: CheckboxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: CheckboxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: CheckboxView
          description: Add token as git credential?
          disabled: false
          indent: true
          layout: IPY_MODEL_fbb4dd278f4c41bea6951ae7e1a44807
          style: IPY_MODEL_69965ccfd13e4f74b13e3bab49621693
          value: true
      2faae4a71f164b2f8d3221e7031f7c5d:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_98dc91397b5a4e06ac54539ace5d6008
          max: 1533
          min: 0
          orientation: horizontal
          style: IPY_MODEL_15d76178b9ae41f2845f4c321a661f71
          value: 1533
      3028075e6f764595be88041e0c57be5e:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      30e00814a02b4418ae7aac4960d34509:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_66ddd19fcece46459c58667cb1540204
          - IPY_MODEL_94952db942a54178ae7b88f09d8d1c10
          - IPY_MODEL_49f4efcde807498a8bbb3797936e7c0d
          layout: IPY_MODEL_3165f71df4e8452a84591587650a3372
      30ef8f78a00c478d8ceae5ac748596c1:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      3165f71df4e8452a84591587650a3372:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      321803dfc6364afc92cab88e6d0e7480:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_c20a1dbaf9f1451aa2539a26df64373b
          - IPY_MODEL_fe0e5d0ef991465582bc725ad035f8f1
          - IPY_MODEL_833463f14ae74e41a31d2d28490b5a13
          layout: IPY_MODEL_699ddf13358c479a8bd358b0dbec4960
      325b31c39ea04cb89029eacecf34a292:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      3382c1f0bf61454795e30f0c59ecef7f:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_8d57d2376e0b462691c4e23506093b7d
          placeholder: ​
          style: IPY_MODEL_2dde06f1d3b144a09e936c04d5de4f48
          value: "config.json: 100%"
      34604b5d96be41aeb808a27363f559ee:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_b5e7700700ec4900839b29fa7a34a32d
          placeholder: ​
          style: IPY_MODEL_cc7eb60760a643cca254541679995c9b
          value: "model.safetensors: 100%"
      34ff2baa144f48f89e2c4a48a2ede3f5:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      36478c2360ea4b839374b02e6914a649:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ButtonStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ButtonStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      36f8f78cf4c24d61ae3c7a98ed015fdb:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_974866637b004005a6194fe5ad4b601a
          max: 384
          min: 0
          orientation: horizontal
          style: IPY_MODEL_96a3f0195b4e4a9d96fa317be22c218e
          value: 384
      373c76c943f34c5daae5ec45f87b1f39:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      3c952e7619f34e59b4cf1b016fb7fd9e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      3deb824fdd1b4cc1b08558fd59dcead6:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      3eecbd4f17ed4241b4dcd6812171ce4a:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      3f16382a00044f90b8b265c15590bba5:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      4037ec13dfdd431eb11dbca223aff328:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
          width: 20px
      40d306006f9841e39b95eef6e6c7d2e5:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      412c4c80893c4e88ad3726917820f64e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_a71dede6d2274f779f3fe8970bfc9478
          - IPY_MODEL_daf443d441924d109caf724aeb44d086
          - IPY_MODEL_0b82a4ee13024df5ad273bc7c383b5e3
          layout: IPY_MODEL_5200b26bb19b4ff884070678878886de
      466b531512314a60b73f38084c19edf0:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      46fe6550d4ce4bf5b8cbaa59443749c5:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      47124271b3cd4450beed89f89613d87f:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      49633f7dbdac41078ac1536a50d3faba:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      49f4efcde807498a8bbb3797936e7c0d:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_efaa953e70b64ae4b8913317652d7389
          placeholder: ​
          style: IPY_MODEL_7be483ea98b14adc944e56fab77f0ee2
          value: " 1.65M/? \\[00:00&lt;00:00, 55.7MB/s\\]"
      4d2d121b6a754d33accf12bef5661c00:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      4ed77ead4c984f82b61c4352311789f7:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      50478db9896f4a778b056c456ea9b1d1:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_34604b5d96be41aeb808a27363f559ee
          - IPY_MODEL_18b7b98e6e9e488a8f2324acfa1dc2ec
          - IPY_MODEL_5a71c22e53744a439ec6c544ce67c471
          layout: IPY_MODEL_5595752b32c546c5b3ecbf20a0432aea
      5200b26bb19b4ff884070678878886de:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      5298fe0ba29f4580896a5f3bce64ebc7:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      54ccee04dbd54f97a8e14db0c278bae4:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      5595752b32c546c5b3ecbf20a0432aea:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      56adc9cf06db4e019b3b2f98610b507b:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      5736f03587404ff29ee5ebbd9f0dbbe6:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      58e5f5e17f7148b99507ddcf4f2c213d:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      59164e7275204cf393aaa3ad85a62412:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_29112341dd5a4c9e81a8cebcd78b1fdb
          placeholder: ​
          style: IPY_MODEL_e3a6998607d3416e9c4bf2b87f5a0e32
          value: " 1.65M/? \\[00:00&lt;00:00, 18.1MB/s\\]"
      5954646402594b57b5d6992714193451:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      5a7128746e6c483d95c3b74bf22ab256:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      5a71c22e53744a439ec6c544ce67c471:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_8551f551b1344e469ea08f63d60c8cc5
          placeholder: ​
          style: IPY_MODEL_2721df7509ab45e29e3985118a1f4e98
          value: " 711M/711M \\[00:11&lt;00:00, 82.6MB/s\\]"
      5add427adcdb42f1a581c13f71e70069:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      5b4754e60dfd41a696046111c1bee5e9:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_86808e1cd4414eafa04015620b6e22ba
          placeholder: ​
          style: IPY_MODEL_95a6970d52bc4e0286a4ba73d692c932
          value: " 384/0 \\[00:00&lt;00:00, 16532.50 examples/s\\]"
      5f8ba7b861fa4611981defd4ee46ca8f:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      6102dd02e1dd44588c0c11547060c808:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      612f4d893d294e249309eb4142958b44:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      618f92d640c444bda57c245643bc8bc1:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
          width: 20px
      61cc6d8dc1444cdd94f860a634d42b0f:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      61e7211162bc4ee6ae3323fa3283a2cf:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_95a695d77ff443c4abb48da51b80b8e0
          max: 24
          min: 0
          orientation: horizontal
          style: IPY_MODEL_95d8fa589c394aefa3d72f9c99e97a11
          value: 24
      63a59279bba24361a41f5ba8d467e585:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_a15e986b23f547c1bb6579c4b63f00f7
          - IPY_MODEL_36f8f78cf4c24d61ae3c7a98ed015fdb
          - IPY_MODEL_25e5974b6216436fb8b3bfde2d9847b2
          layout: IPY_MODEL_b4978e26b4654b55a011d5fa1282d16b
      63b6762fa4844883939466cc387d9577:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      63c7fa8a5f4c45689066cc335acf4df0:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      64959a25dba1423985c03fbd80dd8eb0:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      664697cbfe554c94b9dea9f2ff065c63:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_5298fe0ba29f4580896a5f3bce64ebc7
          placeholder: ​
          style: IPY_MODEL_781766d14cb14fa39636645f57f4cafb
          value: " 5.07M/5.07M \\[00:00&lt;00:00, 90.7MB/s\\]"
      66a01127eee04a9aa0a73885162958b0:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      66ddd19fcece46459c58667cb1540204:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_ddf3375caf174517be0f0efeb3b3b4be
          placeholder: ​
          style: IPY_MODEL_373c76c943f34c5daae5ec45f87b1f39
          value: "vocab.txt: "
      670feff24c6b46d0b398a1cbebc066f2:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ButtonModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ButtonModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ButtonView
          description: Login
          disabled: false
          layout: IPY_MODEL_c8e9d8f80e2e4d8a88397cd34e9fbd95
          style: IPY_MODEL_36478c2360ea4b839374b02e6914a649
      698aa1e3861e44b1bb84278714d77de3:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      69965ccfd13e4f74b13e3bab49621693:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      699ddf13358c479a8bd358b0dbec4960:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      69bf04f2ba7144618eb948f35dde63a9:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      69cb8250c15240b988e5f8620befec9c:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      69f8fcb03fc8448698929699c21bc487:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      6a37b354666a4548a09a6cacad71b52e:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      6b7b693cb64e4e539cde8ba403ef7504:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_fd8adeb8dc94489496e6d36dbb90234f
          max: 25
          min: 0
          orientation: horizontal
          style: IPY_MODEL_aed1227721f84cd196232dd017c3b4e1
          value: 25
      6bef76c6ee614a66bdfbac9405125638:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_4037ec13dfdd431eb11dbca223aff328
          max: 1
          min: 0
          orientation: horizontal
          style: IPY_MODEL_9c3010ea047946d5a49e11de7bdc9e14
          value: 1
      6e1ba3f2f338463a826899d1e2ca5f25:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
          width: 20px
      6fed06e3712843f89c935af8754a599f:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_34ff2baa144f48f89e2c4a48a2ede3f5
          placeholder: ​
          style: IPY_MODEL_e191c218837d4b0aac93c597e7d9648c
          value: " \\<b\\>Pro Tip:\\</b\\> If you don\\'t already have one,
            you can create a dedicated \\'notebooks\\' token with
            \\'write\\' access, that you can then easily reuse for all
            notebooks. \\</center\\>"
      7321fd3876994b0db7e8581bf0844b58:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      7416163fdde4402fb45abe866eb09c2b:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_008b664059424c97b0e5d5492e3cbdfb
          - IPY_MODEL_9c3eb70aa33c450086ffbd7796e25a0a
          - IPY_MODEL_664697cbfe554c94b9dea9f2ff065c63
          layout: IPY_MODEL_466b531512314a60b73f38084c19edf0
      7700a527a2964106b8c3eb26eb3c37e9:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
          width: 20px
      775652227abe420eab930dc26de3895a:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      781766d14cb14fa39636645f57f4cafb:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      78acf5556e804ff2af33d15186a58d68:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      78f49e5347b4488c892ebbd109fb8ec1:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_69f8fcb03fc8448698929699c21bc487
          placeholder: ​
          style: IPY_MODEL_18b8ffaac83e457eab6a37f397611bbe
          value: " 150/150 \\[00:00&lt;00:00, 11.8kB/s\\]"
      79f7df086bdf44868fdee2441309c874:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      7b2ea1d14e9448daab068ffafbb3dc08:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      7b7375a62dae4b6c9f3de6fc1ea4db47:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_30ef8f78a00c478d8ceae5ac748596c1
          placeholder: ​
          style: IPY_MODEL_f890997f70f94fe6aac5e7354f55a35f
          value: "config.json: 100%"
      7be483ea98b14adc944e56fab77f0ee2:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      7d120c3e8ffa4fef867b052f2226fde2:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      7d7a8e6d7fea457a9505d1cd1933f502:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_f64047d052d544b3ad88b6694685e779
          placeholder: ​
          style: IPY_MODEL_1880c60e7fd44b339cb8f5288d8cbbcb
          value: "tokenizer_config.json: 100%"
      804ecde7592c4e66aff386cd4953effa:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_4ed77ead4c984f82b61c4352311789f7
          placeholder: ​
          style: IPY_MODEL_fcbac45cfaf84ad4b016dfabe19a5c17
          value: "Generating test split: "
      80aa53fe361840d89c7389dea2f211e9:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      80f5e32430434d8da997d9d883e956d4:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_82e7ddfd97124947bdb1d4dfd911e6e6
          placeholder: ​
          style: IPY_MODEL_d59529585d6a4990989a2d22e687822c
          value: "Map: 100%"
      82e7ddfd97124947bdb1d4dfd911e6e6:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      833463f14ae74e41a31d2d28490b5a13:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_f58f553680e84b479e7a0acf59a61003
          placeholder: ​
          style: IPY_MODEL_63c7fa8a5f4c45689066cc335acf4df0
          value: " 112/112 \\[00:00&lt;00:00, 13.6kB/s\\]"
      84aac9feab404ac8a20ebc22063afaba:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      8551f551b1344e469ea08f63d60c8cc5:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      86808e1cd4414eafa04015620b6e22ba:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      86ee77b3779d473abe168c570612fd35:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      8777dcbad99e4b25b7813c730265a158:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_64959a25dba1423985c03fbd80dd8eb0
          max: 642
          min: 0
          orientation: horizontal
          style: IPY_MODEL_7d120c3e8ffa4fef867b052f2226fde2
          value: 642
      8790f72102f54bc6a9a818d1df7f8b62:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      87dd6e8be8324f8293676d77fe4a0b9e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_7700a527a2964106b8c3eb26eb3c37e9
          max: 1
          min: 0
          orientation: horizontal
          style: IPY_MODEL_f18313a2fa384e109c5ea1d869c050e5
          value: 1
      8818dec809414607906a91c7a866fc92:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_19cf0daa9ca040489a50e859f993a604
          - IPY_MODEL_9d88cea4f3374b96a6d1200d2ab846ea
          - IPY_MODEL_59164e7275204cf393aaa3ad85a62412
          layout: IPY_MODEL_896a04317a52466fba12527bf914435c
      88c8bdd9445e4f1d86f5b77240d0b4cb:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      896a04317a52466fba12527bf914435c:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      8a7c4d8fee364f2e96d049dec93aa7c0:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_7b7375a62dae4b6c9f3de6fc1ea4db47
          - IPY_MODEL_8777dcbad99e4b25b7813c730265a158
          - IPY_MODEL_19e5313893d247d79e33ab10dbd36bdc
          layout: IPY_MODEL_168996ecb9124b67b991fb07f9f823e0
      8ceee63ec20144349a805c55bf1bd92c:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_af5fe5fd6cf04f5bbb73c1abe7d90c6b
          max: 714355318
          min: 0
          orientation: horizontal
          style: IPY_MODEL_47124271b3cd4450beed89f89613d87f
          value: 714355318
      8d57d2376e0b462691c4e23506093b7d:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      8d972cb129b2460b829a84d17b0207ae:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      8d98847c315b469199170896a9437c80:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      8dad3753b0c748ad9bbdbb24e98850d2:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      8ecede5a2732458f8d86c01f7a2d353f:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      919690191da0461b8302d3bbea99f445:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      91ad9db5e34c494e978a95453f34fb4b:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      92e8122b2f0e4c7bb5b12129beb292b0:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      944d7d60b5b34fa98fb69baba931ff8b:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      94952db942a54178ae7b88f09d8d1c10:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_618f92d640c444bda57c245643bc8bc1
          max: 1
          min: 0
          orientation: horizontal
          style: IPY_MODEL_096a2cc9ea7c4f7b805e6fa209c800b8
          value: 1
      94f24db4f57541b596ec6a6b66729466:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_c222879b824140478d10b39b22081e48
          - IPY_MODEL_0f9cef7c697d487c82d5ed2d57c08432
          - IPY_MODEL_d7160671464b4c8bbc44bb815191411e
          layout: IPY_MODEL_cf1034607318491288fa59b0156d4ce8
      95095f93c5f749638f99da42b033fe8c:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      95a695d77ff443c4abb48da51b80b8e0:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      95a6970d52bc4e0286a4ba73d692c932:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      95d59470f19a41e49c48fecca45b1f48:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      95d8fa589c394aefa3d72f9c99e97a11:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      96a3f0195b4e4a9d96fa317be22c218e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      974866637b004005a6194fe5ad4b601a:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      980f91b4f71f4d648e3c5da59bbc0987:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      98dc91397b5a4e06ac54539ace5d6008:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      9a0666df5d5746b1a7a3087bdde74fec:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      9c3010ea047946d5a49e11de7bdc9e14:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      9c3eb70aa33c450086ffbd7796e25a0a:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_a7d679170ff34eb985fa958243719875
          max: 5069051
          min: 0
          orientation: horizontal
          style: IPY_MODEL_698aa1e3861e44b1bb84278714d77de3
          value: 5069051
      9d88cea4f3374b96a6d1200d2ab846ea:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_b628c842763743b4aaefcebf47b8ed02
          max: 1
          min: 0
          orientation: horizontal
          style: IPY_MODEL_4d2d121b6a754d33accf12bef5661c00
          value: 1
      9ecac5858dca4d99abc090bf6fc76800:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      9ef15be7cdf64e279a958579dbeb6683:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_63b6762fa4844883939466cc387d9577
          placeholder: ​
          style: IPY_MODEL_69bf04f2ba7144618eb948f35dde63a9
          value: " 714M/714M \\[00:12&lt;00:00, 63.8MB/s\\]"
      9f92fd8be3c241329e4aaaa4ecbe7ec9:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      a01d3710121241589d341132906e03c7:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_49633f7dbdac41078ac1536a50d3faba
          max: 112
          min: 0
          orientation: horizontal
          style: IPY_MODEL_c5e979cfc4854bff864675b6052a79df
          value: 112
      a13d4eb395f9463b98f498d1783af52a:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      a15e986b23f547c1bb6579c4b63f00f7:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_22ccf54fea804197bcecc1e1ebcfac24
          placeholder: ​
          style: IPY_MODEL_d0084180a51f44e9ba7432ae36226329
          value: "Map: 100%"
      a27a4f2934774d3ead8421fcd55808c8:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_19972986023746cd82d5d5a704f0dc03
          placeholder: ​
          style: IPY_MODEL_dc006d56ce9a4001947e594d468a9e25
          value: " 24.0/24.0 \\[00:00&lt;00:00, 859B/s\\]"
      a2bcf202747d49d9bf7edc1804939892:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      a3f5899b70204faf94d04ce8457cb141:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_1f5cf6cd71b749c689682a8d7049074c
          placeholder: ​
          style: IPY_MODEL_78acf5556e804ff2af33d15186a58d68
          value: " 734/734 \\[00:00&lt;00:00, 56.1kB/s\\]"
      a4871ff125884d079879ff6bbac9d67e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      a4a93bb4c3d54e5997ae79c944216a8d:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_dea297feda91424c96614795659f025a
          placeholder: ​
          style: IPY_MODEL_84aac9feab404ac8a20ebc22063afaba
          value: "special_tokens_map.json: 100%"
      a594c57e99ab41a49e365eb542702bbc:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      a656bf0fec4c4ac8b0a1baca9b516e1e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      a6da16f61f2340bab99744db0a48a285:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      a71dede6d2274f779f3fe8970bfc9478:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_5736f03587404ff29ee5ebbd9f0dbbe6
          placeholder: ​
          style: IPY_MODEL_980f91b4f71f4d648e3c5da59bbc0987
          value: "model.safetensors: 100%"
      a7d679170ff34eb985fa958243719875:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      a8663f1a212348e2bcd47d38ade8fbfd:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      abda6af9d95d4359a8ed41f402f63126:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
          align_items: center
          display: flex
          flex_flow: column
          width: 50%
      ac43528ff7d043df93e3a528ad346935:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      aca4a3e4f45741f6838ed0615db70127:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      acd8631e4e6542669f1a5ed2b7d8612e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      adfb78321f364a16bda53cf1baf12500:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_7b2ea1d14e9448daab068ffafbb3dc08
          placeholder: ​
          style: IPY_MODEL_f86b0f7567834db7b6d42b8bbedd8ea6
          value: "special_tokens_map.json: 100%"
      ae69a085f6cb4a808506480d5013e591:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_158c5b34728f49d5b5c38d5c39344b31
          placeholder: ​
          style: IPY_MODEL_acd8631e4e6542669f1a5ed2b7d8612e
          value: "pytorch_model.bin: 100%"
      ae8a2c977c8548a58725b1fa2700b07e:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      aed1227721f84cd196232dd017c3b4e1:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      af245cff633249f0a4d4b711df220205:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_d4bf375839b34352904c9a6bd1064fa4
          placeholder: ​
          style: IPY_MODEL_0020cc28ae584c33b30279db6d93e3ac
          value: " 7276/7276 \\[00:02&lt;00:00, 2889.50 examples/s\\]"
      af5fe5fd6cf04f5bbb73c1abe7d90c6b:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      b0df3706a8924d18ab00ae6273c99395:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_8d98847c315b469199170896a9437c80
          placeholder: ​
          style: IPY_MODEL_6102dd02e1dd44588c0c11547060c808
          value: "Generating train split: "
      b128d973246947899a8a15c118cd7b29:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      b2e74fb169c94f6c956f291ef80b08d5:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      b4978e26b4654b55a011d5fa1282d16b:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      b4c8eb474dac4de1be418b2cf305247c:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_b0df3706a8924d18ab00ae6273c99395
          - IPY_MODEL_bf986cb679b14715b18f6d74b5d55716
          - IPY_MODEL_f96be65a21c7452f803e9ef4e991365a
          layout: IPY_MODEL_d1db3f9b00814b4fb4dedea15806a456
      b5e7700700ec4900839b29fa7a34a32d:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      b628c842763743b4aaefcebf47b8ed02:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
          width: 20px
      be342ef282734fc089c3485cd793a9aa:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      bf666b6b8eab4618aaa834c27fc9388a:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      bf986cb679b14715b18f6d74b5d55716:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_6e1ba3f2f338463a826899d1e2ca5f25
          max: 1
          min: 0
          orientation: horizontal
          style: IPY_MODEL_a13d4eb395f9463b98f498d1783af52a
          value: 1
      c18afabb3dfa40308dbe19e2dad55bf4:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_efaa5bc01b8c43a493eb7e4f991c63b3
          - IPY_MODEL_6b7b693cb64e4e539cde8ba403ef7504
          - IPY_MODEL_d26071709f33473a9a39858a829febec
          layout: IPY_MODEL_ae8a2c977c8548a58725b1fa2700b07e
      c20a1dbaf9f1451aa2539a26df64373b:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_3028075e6f764595be88041e0c57be5e
          placeholder: ​
          style: IPY_MODEL_0d10bfc6078547f580a8d078ec69f817
          value: "special_tokens_map.json: 100%"
      c222879b824140478d10b39b22081e48:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_61cc6d8dc1444cdd94f860a634d42b0f
          placeholder: ​
          style: IPY_MODEL_5a7128746e6c483d95c3b74bf22ab256
          value: "config.json: 100%"
      c2dd68b396384a48bd234876d0bd886b:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_7d7a8e6d7fea457a9505d1cd1933f502
          - IPY_MODEL_16d209443db542308bdc10e012128799
          - IPY_MODEL_a27a4f2934774d3ead8421fcd55808c8
          layout: IPY_MODEL_c55ef09951ee4562b0ae8e3b348351af
      c3f920583d5b411bb2d1f0084218628c:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      c41542737a394a9fb7b6b5fde74cdad6:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_3382c1f0bf61454795e30f0c59ecef7f
          - IPY_MODEL_cbe20cd9c29146e492a563859480f123
          - IPY_MODEL_a3f5899b70204faf94d04ce8457cb141
          layout: IPY_MODEL_aca4a3e4f45741f6838ed0615db70127
      c445f39e094d4bc39bfc207fdd88c88e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_2a2afff6f3344fd686e4f47484cde10b
          max: 150
          min: 0
          orientation: horizontal
          style: IPY_MODEL_143362d404c449f7b130860c59ddcfdf
          value: 150
      c55ef09951ee4562b0ae8e3b348351af:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      c5e979cfc4854bff864675b6052a79df:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      c77aad8f07fd4f75a249ce55892340d7:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_adfb78321f364a16bda53cf1baf12500
          - IPY_MODEL_a01d3710121241589d341132906e03c7
          - IPY_MODEL_07692bff93684717ac1319f627553b9d
          layout: IPY_MODEL_a6da16f61f2340bab99744db0a48a285
      c8e9d8f80e2e4d8a88397cd34e9fbd95:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      cade815c501d472980533c05e09f444e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      cbe20cd9c29146e492a563859480f123:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_f891f71312b14c51a014fc3e05add3a2
          max: 734
          min: 0
          orientation: horizontal
          style: IPY_MODEL_5add427adcdb42f1a581c13f71e70069
          value: 734
      cc6d105c60814a55b30275500849812f:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_95d59470f19a41e49c48fecca45b1f48
          placeholder: ​
          style: IPY_MODEL_d200360e02c7415dade052b589dde182
          value: " 1533/1533 \\[00:00&lt;00:00, 1828.81 examples/s\\]"
      cc7eb60760a643cca254541679995c9b:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      cdd9347778a149588967e10a2c007949:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_ae69a085f6cb4a808506480d5013e591
          - IPY_MODEL_0b45604901f0407887ec290a69dde87d
          - IPY_MODEL_1df990856aa64a258655fed9771acb07
          layout: IPY_MODEL_58e5f5e17f7148b99507ddcf4f2c213d
      ce590e850b2b4771b716039ec731b853:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      cf1034607318491288fa59b0156d4ce8:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      d0084180a51f44e9ba7432ae36226329:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      d1ba5e5346d94920bb17fecff7b8a0e2:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      d1db3f9b00814b4fb4dedea15806a456:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      d200360e02c7415dade052b589dde182:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      d26071709f33473a9a39858a829febec:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_a8663f1a212348e2bcd47d38ade8fbfd
          placeholder: ​
          style: IPY_MODEL_775652227abe420eab930dc26de3895a
          value: " 25.0/25.0 \\[00:00&lt;00:00, 2.67kB/s\\]"
      d3155521625d456e9438067b8a6ee241:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      d4bf375839b34352904c9a6bd1064fa4:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      d59529585d6a4990989a2d22e687822c:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      d5a28cfa691d4053972e34dc383a1edc:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      d7160671464b4c8bbc44bb815191411e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_325b31c39ea04cb89029eacecf34a292
          placeholder: ​
          style: IPY_MODEL_0315765bb52e4924a9be49d4e44d367d
          value: " 642/642 \\[00:00&lt;00:00, 53.2kB/s\\]"
      d77c3e68f8eb40c29b353dd6f1232def:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_9f92fd8be3c241329e4aaaa4ecbe7ec9
          placeholder: ​
          style: IPY_MODEL_69cb8250c15240b988e5f8620befec9c
          value: " 24.0/24.0 \\[00:00&lt;00:00, 2.42kB/s\\]"
      daf443d441924d109caf724aeb44d086:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_8ecede5a2732458f8d86c01f7a2d353f
          max: 2243825580
          min: 0
          orientation: horizontal
          style: IPY_MODEL_2ad31e03da334b41bb278d8236105a89
          value: 2243825580
      dc006d56ce9a4001947e594d468a9e25:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      dd2bb23176994fd9a9ef5521d9711f05:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_f5ae284c066b448a9edeab803fce132a
          placeholder: ​
          style: IPY_MODEL_d5a28cfa691d4053972e34dc383a1edc
          value: " 7276/0 \\[00:00&lt;00:00, 97417.41 examples/s\\]"
      dd4f5d39f7c243bc882d55a9cecbb8a5:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_e4ec9554b90842a5b8b543bdb19de199
          - IPY_MODEL_61e7211162bc4ee6ae3323fa3283a2cf
          - IPY_MODEL_d77c3e68f8eb40c29b353dd6f1232def
          layout: IPY_MODEL_c3f920583d5b411bb2d1f0084218628c
      ddf3375caf174517be0f0efeb3b3b4be:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      dea297feda91424c96614795659f025a:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      dfc7455d960e4528a99505807a2ac149:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      e191c218837d4b0aac93c597e7d9648c:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      e3a6998607d3416e9c4bf2b87f5a0e32:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      e4ad5c06be9a41d8abdb0b6202556a9e:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: VBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: VBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: VBoxView
          children:
          - IPY_MODEL_fcbe0c60b85447298edcea69ee3e559a
          - IPY_MODEL_11cab298fa6c45a18bed1f1502b6212a
          - IPY_MODEL_2f0b973a5146492ebeb5c1c9432098d9
          - IPY_MODEL_670feff24c6b46d0b398a1cbebc066f2
          - IPY_MODEL_6fed06e3712843f89c935af8754a599f
          layout: IPY_MODEL_abda6af9d95d4359a8ed41f402f63126
      e4ec9554b90842a5b8b543bdb19de199:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_54ccee04dbd54f97a8e14db0c278bae4
          placeholder: ​
          style: IPY_MODEL_8790f72102f54bc6a9a818d1df7f8b62
          value: "tokenizer_config.json: 100%"
      efaa5bc01b8c43a493eb7e4f991c63b3:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_8d972cb129b2460b829a84d17b0207ae
          placeholder: ​
          style: IPY_MODEL_19fe740fec3844a6b309c24ee2946f6d
          value: "tokenizer_config.json: 100%"
      efaa953e70b64ae4b8913317652d7389:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      f18313a2fa384e109c5ea1d869c050e5:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: ProgressStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: ProgressStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      f39890f25b4647e6b20538e409c8facd:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_2ece6ea27e904cf3b9c9ecdb2e827941
          - IPY_MODEL_2faae4a71f164b2f8d3221e7031f7c5d
          - IPY_MODEL_cc6d105c60814a55b30275500849812f
          layout: IPY_MODEL_5954646402594b57b5d6992714193451
      f58f553680e84b479e7a0acf59a61003:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      f5ae284c066b448a9edeab803fce132a:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      f64047d052d544b3ad88b6694685e779:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      f86b0f7567834db7b6d42b8bbedd8ea6:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      f890997f70f94fe6aac5e7354f55a35f:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      f891f71312b14c51a014fc3e05add3a2:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      f96be65a21c7452f803e9ef4e991365a:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_95095f93c5f749638f99da42b033fe8c
          placeholder: ​
          style: IPY_MODEL_8dad3753b0c748ad9bbdbb24e98850d2
          value: " 1533/0 \\[00:00&lt;00:00, 36589.26 examples/s\\]"
      f991de4987c442b1b541eec3971948af:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_1bad8e754f0b4f039cbe976ed5b3b66a
          - IPY_MODEL_8ceee63ec20144349a805c55bf1bd92c
          - IPY_MODEL_9ef15be7cdf64e279a958579dbeb6683
          layout: IPY_MODEL_86ee77b3779d473abe168c570612fd35
      fbb4dd278f4c41bea6951ae7e1a44807:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      fcbac45cfaf84ad4b016dfabe19a5c17:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: DescriptionStyleModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: DescriptionStyleModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: StyleView
      fcbe0c60b85447298edcea69ee3e559a:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HTMLModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HTMLModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HTMLView
          layout: IPY_MODEL_b2e74fb169c94f6c956f291ef80b08d5
          placeholder: ​
          style: IPY_MODEL_be342ef282734fc089c3485cd793a9aa
          value: "\\<center\\> \\<img
            src=https://huggingface.co/front/assets/huggingface_logo-noborder.svg
            alt=\\'Hugging Face\\'\\> \\<br\\> Copy a token from \\<a
            href=\\\"https://huggingface.co/settings/tokens\\\"
            target=\\\"\\_blank\\\"\\>your Hugging Face tokens page\\</a\\> and
            paste it below. \\<br\\> Immediately click login after copying
            your token or it might be stored in plain text in this
            notebook file. \\</center\\>"
      fd8adeb8dc94489496e6d36dbb90234f:
        model_module: \@jupyter-widgets/base
        model_module_version: 1.2.0
        model_name: LayoutModel
        state:
          _model_module: \@jupyter-widgets/base
          _model_module_version: 1.2.0
          _model_name: LayoutModel
          _view_module: \@jupyter-widgets/base
          _view_module_version: 1.2.0
          _view_name: LayoutView
      fe0e5d0ef991465582bc725ad035f8f1:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: FloatProgressModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: FloatProgressModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: ProgressView
          bar_style: success
          layout: IPY_MODEL_3deb824fdd1b4cc1b08558fd59dcead6
          max: 112
          min: 0
          orientation: horizontal
          style: IPY_MODEL_01e7d116e0ea4283b3207b2f71da1f7c
          value: 112
      fe2423fdc49442c29976f8f427ead72a:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_804ecde7592c4e66aff386cd4953effa
          - IPY_MODEL_87dd6e8be8324f8293676d77fe4a0b9e
          - IPY_MODEL_dd2bb23176994fd9a9ef5521d9711f05
          layout: IPY_MODEL_46fe6550d4ce4bf5b8cbaa59443749c5
      ffac6e99afa34044a550292cbdafe593:
        model_module: \@jupyter-widgets/controls
        model_module_version: 1.5.0
        model_name: HBoxModel
        state:
          _model_module: \@jupyter-widgets/controls
          _model_module_version: 1.5.0
          _model_name: HBoxModel
          _view_module: \@jupyter-widgets/controls
          _view_module_version: 1.5.0
          _view_name: HBoxView
          children:
          - IPY_MODEL_a4a93bb4c3d54e5997ae79c944216a8d
          - IPY_MODEL_c445f39e094d4bc39bfc207fdd88c88e
          - IPY_MODEL_78f49e5347b4488c892ebbd109fb8ec1
          layout: IPY_MODEL_66a01127eee04a9aa0a73885162958b0
---

::: {.cell .markdown id="ySerN3HRcBL8"}
# Загрузка данных, которые были преобразованы в предыдущем ноутбуке
:::

::: {.cell .code execution_count="1" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="wS6AS56ndjuA" outputId="e450f575-3a17-4184-c6f2-044d430a724d"}
``` python
from google.colab import drive
drive.mount('/content/drive')
```

::: {.output .stream .stdout}
    Mounted at /content/drive
:::
:::

::: {.cell .code execution_count="2" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="YZc3H3EEZnK8" outputId="1d6af073-8bb4-4158-b76f-41911f3c2278"}
``` python
!pip install -q transformers huggingface_hub catboost
```

::: {.output .stream .stdout}
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 99.2/99.2 MB 6.5 MB/s eta 0:00:00
:::
:::

::: {.cell .code execution_count="3" id="AXkFT-07a6tx"}
``` python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
from tqdm import tqdm
import torch
warnings.filterwarnings('ignore')
```
:::

::: {.cell .code execution_count="4" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":224}" id="0IMa9Erta8A0" outputId="3fa8a24e-fe6b-479e-fc5c-4f975510e8ef"}
``` python
train = pd.read_csv('/content/drive/MyDrive/NLP_CASE_FINAL/train_1692.csv')
print(train.shape[0])
train.head()
```

::: {.output .stream .stdout}
    1692
:::

::: {.output .execute_result execution_count="4"}
``` json
{"summary":"{\n  \"name\": \"train\",\n  \"rows\": 1692,\n  \"fields\": [\n    {\n      \"column\": \"text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 1692,\n        \"samples\": [\n          \"\\u041e\\u0447\\u0435\\u043d\\u044c \\u043f\\u0440\\u043e\\u0437\\u0440\\u0430\\u0447\\u043d\\u043e\\u0435 \",\n          \"\\u043e\\u0447\\u0435\\u043d\\u044c \\u0440\\u0430\\u0437\\u043e\\u0447\\u0430\\u0440\\u043e\\u0432\\u0430\\u043b\\u043e, \\u0447\\u0442\\u043e \\u0438\\u043c\\u0435\\u0435\\u0442\\u0441\\u044f \\u0448\\u043e\\u0432, \\u0432 \\u043e\\u043f\\u0438\\u0441\\u0430\\u043d\\u0438\\u0438 \\u0435\\u0433\\u043e \\u043d\\u0435 \\u0431\\u044b\\u043b\\u043e\",\n          \"\\u043e\\u0447\\u0435\\u043d\\u044c \\u0448\\u0438\\u0440\\u043e\\u043a\\u0430\\u044f \\u043c\\u0430\\u0439\\u043a\\u0430, \\u043a\\u0430\\u043a \\u043d\\u0430\\u0432\\u043e\\u043b\\u043e\\u0447\\u043a\\u0430\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}","type":"dataframe","variable_name":"train"}
```
:::
:::

::: {.cell .code execution_count="5" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":224}" id="8qlM0xMVbDkh" outputId="831887c3-2493-4350-c6b5-428534123ec0"}
``` python
valid = pd.read_csv('/content/drive/MyDrive/NLP_CASE_FINAL/valid_126.csv')
print(valid.shape[0])
valid.head()
```

::: {.output .stream .stdout}
    126
:::

::: {.output .execute_result execution_count="5"}
``` json
{"summary":"{\n  \"name\": \"valid\",\n  \"rows\": 126,\n  \"fields\": [\n    {\n      \"column\": \"text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 126,\n        \"samples\": [\n          \"\\u0412 \\u0446\\u0435\\u043b\\u043e\\u043c \\u043f\\u043e\\u043d\\u0440\\u0430\\u0432\\u0438\\u043b\\u0441\\u044f\\uff01  \\u0441\\u0435\\u043b \\u043d\\u0430 48 \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440 \\u0438\\u0434\\u0435\\u0430\\u043b\\u044c\\u043d\\u043e. \\u0415\\u0434\\u0438\\u043d\\u0441\\u0442\\u0432\\u0435\\u043d\\u043d\\u0438\\u0439 \\u043c\\u0438\\u043d\\u0443\\u0441 - \\u043f\\u0440\\u0438 \\u043f\\u0435\\u0440\\u0432\\u043e\\u0439 \\u0436\\u0435 \\u0441\\u0442\\u0438\\u0440\\u043a\\u0435 \\u043b\\u0438\\u043d\\u044f\\u043b \\u0441\\u0438\\u043b\\u044c\\u043d\\u043e, \\u0442\\u0430\\u043a \\u0447\\u0442\\u043e \\u0441\\u043e\\u0432\\u0435\\u0442\\u0443\\u044e \\u0441\\u0442\\u0438\\u0440\\u0430\\u0442\\u044c \\u043e\\u0442\\u0434\\u0435\\u043b\\u044c\\u043d\\u043e \\u0432\\u0440\\u0443\\u0447\\u043d\\u0443\\u044e.\",\n          \"\\u0443\\u0440\\u0430! \\u043e\\u0431\\u043e\\u0436\\u0430\\u044e \\u044d\\u0442\\u043e\\u0442 \\u0434\\u0436\\u0435\\u043c\\u043f\\u0435\\u0440! \\u0443 \\u043c\\u0435\\u043d\\u044f \\u0442\\u0430\\u043a\\u043e\\u0439 \\u0435\\u0449\\u0435 \\u0441\\u0435\\u0440\\u044b\\u0439 \\u0435\\u0441\\u0442\\u044c. \\u043e\\u0447\\u0435\\u043d\\u044c \\u043a\\u0440\\u0430\\u0441\\u0438\\u0432\\u044b\\u0439 \\u0438 \\u0442\\u0435\\u043f\\u043b\\u044b\\u0439! \\u043e\\u0442\\u0434\\u0435\\u043b\\u044c\\u043d\\u043e\\u0435 \\u0441\\u043f\\u0430\\u0441\\u0438\\u0431\\u043e \\u043f\\u0440\\u043e\\u0434\\u0430\\u0432\\u0446\\u0443 \\u0437\\u0430 \\u0442\\u043e, \\u0447\\u0442\\u043e \\u043d\\u0430\\u0448\\u0435\\u043b \\u0434\\u043b\\u044f \\u043c\\u0435\\u043d\\u044f \\u043e\\u0434\\u043d\\u0443 \\u0448\\u0442\\u0443\\u043a\\u0443, \\u043f\\u043e\\u0442\\u043e\\u043c\\u0443 \\u0447\\u0442\\u043e \\u0438\\u0437\\u043d\\u0430\\u0447\\u0430\\u043b\\u044c\\u043d\\u043e \\u0431\\u044b\\u043b\\u0430 \\u0438\\u043d\\u0444\\u0430, \\u0447\\u0442\\u043e \\u0442\\u043e\\u0432\\u0430\\u0440 \\u0437\\u0430\\u043a\\u043e\\u043d\\u0447\\u0438\\u043b\\u0441\\u044f! \\u0441\\u043f\\u0430\\u0441\\u0438\\u0431\\u043e!\",\n          \"\\u0417\\u0434\\u0440\\u0430\\u0432\\u0441\\u0442\\u0432\\u0443\\u0439\\u0442\\u0435.\\u0428\\u0430\\u043f\\u043a\\u0430 \\u043d\\u0435 \\u043f\\u043b\\u043e\\u0445\\u0430\\u044f.\\u0422\\u043e\\u043d\\u043a\\u0430\\u044f \\u0438 \\u0441\\u043b\\u0430\\u0431\\u0430\\u044f \\u0440\\u0435\\u0437\\u0438\\u043d\\u043a\\u0430.\\u041f\\u0440\\u0438 \\u043f\\u0435\\u0440\\u0432\\u043e\\u0439 \\u0436\\u0435 \\u043d\\u043e\\u0441\\u043a\\u0435 \\u0441\\u0438\\u043b\\u044c\\u043d\\u043e \\u0440\\u0430\\u0441\\u0442\\u044f\\u043d\\u0443\\u043b\\u0430\\u0441\\u044c.\\u0428\\u0432\\u044b \\u043d\\u0435 \\u0440\\u043e\\u0432\\u043d\\u044b\\u0435 \\u0438 \\u0432\\u044b\\u0442\\u043e\\u0447\\u043a\\u0438 \\u0441\\u0437\\u0430\\u0434\\u0438 \\u0440\\u0430\\u0441\\u043f\\u043e\\u043b\\u043e\\u0436\\u0435\\u043d\\u044b \\u043d\\u0435 \\u0440\\u043e\\u0432\\u043d\\u043e.\\u041f\\u0440\\u0438\\u0448\\u043b\\u043e\\u0441\\u044c \\u043f\\u0435\\u0440\\u0435\\u0448\\u0438\\u0432\\u0430\\u0442\\u044c.\\u041c\\u043e\\u0436\\u0435\\u0442 \\u044d\\u0442\\u043e \\u0431\\u0440\\u0430\\u043a.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"labels\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 6,\n        \"samples\": [\n          \"\\u043e\\u0434\\u0435\\u0436\\u0434\\u0430\",\n          \"\\u043d\\u0435\\u0442 \\u0442\\u043e\\u0432\\u0430\\u0440\\u0430\",\n          \"\\u0443\\u043a\\u0440\\u0430\\u0448\\u0435\\u043d\\u0438\\u044f \\u0438 \\u0430\\u043a\\u0441\\u0435\\u0441\\u0441\\u0443\\u0430\\u0440\\u044b\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}","type":"dataframe","variable_name":"valid"}
```
:::
:::

::: {.cell .code execution_count="6" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":224}" id="bXi0n3W-bLNT" outputId="9daf5f10-58c3-490c-ed42-a10f5c5d05b3"}
``` python
test = pd.read_csv('/content/drive/MyDrive/NLP_CASE_FINAL/test.csv')
print(test.shape[0])
test.head()
```

::: {.output .stream .stdout}
    7276
:::

::: {.output .execute_result execution_count="6"}
``` json
{"summary":"{\n  \"name\": \"test\",\n  \"rows\": 7276,\n  \"fields\": [\n    {\n      \"column\": \"text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 7276,\n        \"samples\": [\n          \"\\u0422\\u043e\\u0432\\u0430\\u0440 \\u0431\\u044b\\u043b \\u0437\\u0430\\u043a\\u0430\\u0437\\u0430\\u043d 1 \\u043c\\u0430\\u0440\\u0442\\u0430, \\u0447\\u0435\\u0440\\u0435\\u0437 \\u043f\\u0430\\u0440\\u0443 \\u043d\\u0435\\u0434\\u0435\\u043b\\u044c \\u0442\\u0440\\u0435\\u043a\\u0438\\u043d\\u0433 \\u043f\\u043e\\u043a\\u0430\\u0437\\u0430\\u043b \\u0447\\u0442\\u043e \\u0442\\u043e\\u0432\\u0430\\u0440 \\u0432 \\u041c\\u043e\\u0441\\u043a\\u0432\\u0435.\\r\\r\\n\\u0432 \\u043f\\u043e\\u0447\\u0442\\u043e\\u0432\\u043e\\u043c \\u043e\\u0442\\u0434\\u0435\\u043b\\u0435\\u043d\\u0438\\u0438 \\u043d\\u0435 \\u043f\\u043e\\u044f\\u0432\\u0438\\u043b\\u0441\\u044f, \\u043f\\u0440\\u043e\\u0434\\u0430\\u0432\\u0435\\u0446 \\u0442\\u0440\\u0438 \\u0440\\u0430\\u0437\\u0430 \\u043f\\u0440\\u043e\\u0434\\u043b\\u044f\\u043b \\u0441\\u0440\\u043e\\u043a \\u0437\\u0430\\u0449\\u0438\\u0442\\u044b \\u043f\\u043e\\u043a\\u0443\\u043f\\u0430\\u0442\\u0435\\u043b\\u044f, \\u0442\\u043e\\u0432\\u0430\\u0440 \\u043d\\u0435 \\u043f\\u0440\\u0438\\u0448\\u0435\\u043b. \\u043f\\u043e \\u043e\\u0442\\u043a\\u0440\\u044b\\u0442\\u043e\\u043c\\u0443 \\u0441\\u043f\\u043e\\u0440\\u0443 \\u0432\\u0435\\u0440\\u043d\\u0443\\u043b\\u0438 \\u0441\\u0440\\u0435\\u0434\\u0441\\u0442\\u0432\\u0430.\",\n          \"\\u041e\\u0447\\u0435\\u043d\\u044c \\u0445\\u043e\\u0440\\u043e\\u0448\\u0430\\u044f \\u0431\\u043b\\u0443\\u0437\\u043a\\u0430. \\u041f\\u0440\\u043e\\u0441\\u0442\\u043e \\u0441\\u0443\\u043f\\u0435\\u0440. \\u0422\\u043a\\u0430\\u043d\\u044c \\u043d\\u0430\\u0442\\u0443\\u0440\\u0430\\u043b\\u044c\\u043d\\u0430\\u044f. \\u0425\\u043e\\u0440\\u043e\\u0448\\u0438\\u0439 \\u043f\\u043e\\u0448\\u0438\\u0432, \\u043a\\u0440\\u0430\\u0441\\u0438\\u0432\\u044b\\u0439 \\u0446\\u0432\\u0435\\u0442 \\u0438 \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440 \\u043f\\u043e\\u0434\\u043e\\u0448\\u0451\\u043b. \\u041d\\u0430 \\u041e\\u0413 108 \\u0441\\u043c \\u041e\\u0422 95 \\u0441\\u043c. \\u0441\\u0438\\u0434\\u0438\\u0442 \\u0441\\u0432\\u043e\\u0431\\u043e\\u0434\\u043d\\u043e. \\u0421 \\u043c\\u043e\\u043c\\u0435\\u043d\\u0442\\u0430 \\u0437\\u0430\\u043a\\u0430\\u0437\\u0430 \\u0434\\u043e \\u043f\\u043e\\u043b\\u0443\\u0447\\u0435\\u043d\\u0438\\u044f - \\u0434\\u0432\\u0435 \\u043d\\u0435\\u0434\\u0435\\u043b\\u0438.\",\n          \"\\u043e\\u0442\\u043b\\u0438\\u0447\\u043d\\u0430\\u044f \\u0436\\u0438\\u043b\\u0435\\u0442\\u043a\\u0430, \\u043d\\u043e \\u043d\\u0430\\u0434\\u043e \\u0431\\u0440\\u0430\\u0442\\u044c \\u043d\\u0430 \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440 \\u0431\\u043e\\u043b\\u044c\\u0448\\u0435, \\u043c\\u0430\\u043b\\u043e\\u043c\\u0435\\u0440\\u0438\\u0442\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}","type":"dataframe","variable_name":"test"}
```
:::
:::

::: {.cell .markdown id="yOr-DTZbcHr5"}
# Классификация отзывов с помощью RuBERT + CatBoost {#классификация-отзывов-с-помощью-rubert--catboost}
:::

::: {.cell .code execution_count="7" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":331,\"referenced_widgets\":[\"e4ad5c06be9a41d8abdb0b6202556a9e\",\"fcbe0c60b85447298edcea69ee3e559a\",\"11cab298fa6c45a18bed1f1502b6212a\",\"2f0b973a5146492ebeb5c1c9432098d9\",\"670feff24c6b46d0b398a1cbebc066f2\",\"6fed06e3712843f89c935af8754a599f\",\"abda6af9d95d4359a8ed41f402f63126\",\"b2e74fb169c94f6c956f291ef80b08d5\",\"be342ef282734fc089c3485cd793a9aa\",\"0baebae27d844995baf9b6ba5f45a689\",\"919690191da0461b8302d3bbea99f445\",\"fbb4dd278f4c41bea6951ae7e1a44807\",\"69965ccfd13e4f74b13e3bab49621693\",\"c8e9d8f80e2e4d8a88397cd34e9fbd95\",\"36478c2360ea4b839374b02e6914a649\",\"34ff2baa144f48f89e2c4a48a2ede3f5\",\"e191c218837d4b0aac93c597e7d9648c\"]}" id="ru5p8gx3cMjO" outputId="79b6450c-34dd-4e6b-b236-73e3fb224602"}
``` python
from huggingface_hub import notebook_login
notebook_login()
```

::: {.output .display_data}
``` json
{"model_id":"e4ad5c06be9a41d8abdb0b6202556a9e","version_major":2,"version_minor":0}
```
:::
:::

::: {.cell .code execution_count="8" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":226,\"referenced_widgets\":[\"8a7c4d8fee364f2e96d049dec93aa7c0\",\"7b7375a62dae4b6c9f3de6fc1ea4db47\",\"8777dcbad99e4b25b7813c730265a158\",\"19e5313893d247d79e33ab10dbd36bdc\",\"168996ecb9124b67b991fb07f9f823e0\",\"30ef8f78a00c478d8ceae5ac748596c1\",\"f890997f70f94fe6aac5e7354f55a35f\",\"64959a25dba1423985c03fbd80dd8eb0\",\"7d120c3e8ffa4fef867b052f2226fde2\",\"d3155521625d456e9438067b8a6ee241\",\"80aa53fe361840d89c7389dea2f211e9\",\"cdd9347778a149588967e10a2c007949\",\"ae69a085f6cb4a808506480d5013e591\",\"0b45604901f0407887ec290a69dde87d\",\"1df990856aa64a258655fed9771acb07\",\"58e5f5e17f7148b99507ddcf4f2c213d\",\"158c5b34728f49d5b5c38d5c39344b31\",\"acd8631e4e6542669f1a5ed2b7d8612e\",\"40d306006f9841e39b95eef6e6c7d2e5\",\"a656bf0fec4c4ac8b0a1baca9b516e1e\",\"92e8122b2f0e4c7bb5b12129beb292b0\",\"290969b5faed42c1ba9afcb3878d9d21\",\"c2dd68b396384a48bd234876d0bd886b\",\"7d7a8e6d7fea457a9505d1cd1933f502\",\"16d209443db542308bdc10e012128799\",\"a27a4f2934774d3ead8421fcd55808c8\",\"c55ef09951ee4562b0ae8e3b348351af\",\"f64047d052d544b3ad88b6694685e779\",\"1880c60e7fd44b339cb8f5288d8cbbcb\",\"dfc7455d960e4528a99505807a2ac149\",\"79f7df086bdf44868fdee2441309c874\",\"19972986023746cd82d5d5a704f0dc03\",\"dc006d56ce9a4001947e594d468a9e25\",\"8818dec809414607906a91c7a866fc92\",\"19cf0daa9ca040489a50e859f993a604\",\"9d88cea4f3374b96a6d1200d2ab846ea\",\"59164e7275204cf393aaa3ad85a62412\",\"896a04317a52466fba12527bf914435c\",\"88c8bdd9445e4f1d86f5b77240d0b4cb\",\"3f16382a00044f90b8b265c15590bba5\",\"b628c842763743b4aaefcebf47b8ed02\",\"4d2d121b6a754d33accf12bef5661c00\",\"29112341dd5a4c9e81a8cebcd78b1fdb\",\"e3a6998607d3416e9c4bf2b87f5a0e32\",\"50478db9896f4a778b056c456ea9b1d1\",\"34604b5d96be41aeb808a27363f559ee\",\"18b7b98e6e9e488a8f2324acfa1dc2ec\",\"5a71c22e53744a439ec6c544ce67c471\",\"5595752b32c546c5b3ecbf20a0432aea\",\"b5e7700700ec4900839b29fa7a34a32d\",\"cc7eb60760a643cca254541679995c9b\",\"a2bcf202747d49d9bf7edc1804939892\",\"bf666b6b8eab4618aaa834c27fc9388a\",\"8551f551b1344e469ea08f63d60c8cc5\",\"2721df7509ab45e29e3985118a1f4e98\",\"c77aad8f07fd4f75a249ce55892340d7\",\"adfb78321f364a16bda53cf1baf12500\",\"a01d3710121241589d341132906e03c7\",\"07692bff93684717ac1319f627553b9d\",\"a6da16f61f2340bab99744db0a48a285\",\"7b2ea1d14e9448daab068ffafbb3dc08\",\"f86b0f7567834db7b6d42b8bbedd8ea6\",\"49633f7dbdac41078ac1536a50d3faba\",\"c5e979cfc4854bff864675b6052a79df\",\"7321fd3876994b0db7e8581bf0844b58\",\"944d7d60b5b34fa98fb69baba931ff8b\"]}" id="ICA8u4mHcRu7" outputId="55afd2b4-f67f-42ec-8693-9554c582744b"}
``` python
from sentence_transformers import SentenceTransformer
from catboost import CatBoostClassifier

model_name = "DeepPavlov/rubert-base-cased-sentence"
rubert_model = SentenceTransformer(model_name)
```

::: {.output .stream .stderr}
    WARNING:sentence_transformers.SentenceTransformer:No sentence-transformers model found with name DeepPavlov/rubert-base-cased-sentence. Creating a new one with mean pooling.
:::

::: {.output .display_data}
``` json
{"model_id":"8a7c4d8fee364f2e96d049dec93aa7c0","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"cdd9347778a149588967e10a2c007949","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"c2dd68b396384a48bd234876d0bd886b","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"8818dec809414607906a91c7a866fc92","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"50478db9896f4a778b056c456ea9b1d1","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"c77aad8f07fd4f75a249ce55892340d7","version_major":2,"version_minor":0}
```
:::
:::

::: {.cell .code execution_count="9" id="IOZpq6rAcUn1"}
``` python
def get_embeddings(texts, batch_size=32):
    embeddings = []
    for i in tqdm(range(0, len(texts), batch_size), desc="Encoding"):
        batch = texts[i:i+batch_size]
        batch_emb = rubert_model.encode(batch, show_progress_bar=False)
        embeddings.append(batch_emb)
    return np.vstack(embeddings)
```
:::

::: {.cell .code execution_count="10" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":850}" id="xs9KmWnCcnzV" outputId="3ab61a74-ad67-47bd-c1d0-4b8c6d39ea67"}
``` python
embeddings_train = get_embeddings(train["text"].tolist())
embeddings_valid = get_embeddings(valid["text"].tolist())
```

::: {.output .stream .stderr}

    Encoding:   0%|          | 0/53 [00:00<?, ?it/s]
:::
:::

::: {.cell .code execution_count="11" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":1000}" id="kEVxBvvTc2sT" outputId="f80581bd-4e05-4858-f953-74f4e7420632"}
``` python
clf = CatBoostClassifier(
    iterations=500,
    depth=7,
    learning_rate=0.05,
    loss_function="MultiClass",
    eval_metric="TotalF1",
    random_seed=42,
    verbose=100
)

clf.fit(embeddings_valid, valid["labels"])
pseudo_labels = clf.predict(embeddings_train).ravel()
proba = clf.predict_proba(embeddings_train)
max_proba = np.max(proba, axis=1)

threshold = 0.6
pseudo_labels[max_proba < threshold] = "unknown"

train["pseudo_label_rubert"] = pseudo_labels
train["confidence_rubert"] = max_proba

pd.set_option('display.max_colwidth', None)
sample_df = train.sample(n=50, random_state=42)[["text", "pseudo_label_rubert", "confidence_rubert"]]
sample_df.reset_index(drop=True, inplace=True)
sample_df
```

::: {.output .stream .stdout}
    0:	learn: 0.7325958	total: 1.03s	remaining: 8m 35s
    100:	learn: 0.9210441	total: 1m 54s	remaining: 7m 30s
    200:	learn: 1.0000000	total: 2m 58s	remaining: 4m 25s
    300:	learn: 1.0000000	total: 4m 1s	remaining: 2m 39s
    400:	learn: 1.0000000	total: 5m 5s	remaining: 1m 15s
    499:	learn: 1.0000000	total: 6m 9s	remaining: 0us
:::

::: {.output .execute_result execution_count="11"}
``` json
{"summary":"{\n  \"name\": \"sample_df\",\n  \"rows\": 50,\n  \"fields\": [\n    {\n      \"column\": \"text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 50,\n        \"samples\": [\n          \"\\u041a\\u043e\\u0444\\u0442\\u043e\\u0447\\u043a\\u0438 \\u043e\\u0447\\u0435\\u043d\\u044c \\u0445\\u043e\\u0440\\u043e\\u0448\\u0438\\u0435, \\u0437\\u0430\\u043a\\u0430\\u0437\\u044b\\u0432\\u0430\\u043b\\u0430 \\u0440\\u043e\\u0437\\u043e\\u0432\\u0443\\u044e \\u0438 \\u0447\\u0435\\u0440\\u043d\\u0443\\u044e. \\u0420\\u043e\\u0437\\u043e\\u0432\\u0430\\u044f \\u0447\\u0443\\u0442\\u044c \\u043c\\u0435\\u043d\\u044c\\u0448\\u0435 \\u0438 \\u0431\\u043e\\u043b\\u044c\\u0448\\u0435 \\u0432 \\u043e\\u0431\\u0442\\u044f\\u0433, \\u0447\\u0435\\u0440\\u043d\\u0430\\u044f \\u0441\\u0435\\u043b\\u0430 \\u0438\\u0434\\u0435\\u0430\\u043b\\u044c\\u043d\\u043e. \\u0410 \\u0442\\u0430\\u043a \\u043d\\u0430 42-44 \\u043e\\u0431\\u0435 \\u0445\\u043e\\u0440\\u043e\\u0448\\u043e \\u043f\\u043e\\u0434\\u043e\\u0448\\u043b\\u0438.\",\n          \"\\u0442\\u043a\\u0430\\u043d\\u044c - \\u0441\\u0438\\u043d\\u0442\\u0435\\u0442\\u0438\\u043a\\u0430 \\u0441\\u0440\\u0435\\u0434\\u043d\\u0435\\u0433\\u043e \\u043a\\u0430\\u0447\\u0435\\u0441\\u0442\\u0432\\u0430, \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440\\u043d\\u0430\\u044f \\u0441\\u0435\\u0442\\u043a\\u0430 \\u043d\\u0435 \\u0441\\u043e\\u043e\\u0442\\u0432\\u0435\\u0442\\u0441\\u0442\\u0432\\u0443\\u0435\\u0442 \\u0434\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u0442\\u0435\\u043b\\u044c\\u043d\\u043e\\u0441\\u0442\\u0438. \\u041d\\u0438\\u0442\\u043a\\u0438 \\u043d\\u0435 \\u0442\\u043e\\u0440\\u0447\\u0430\\u0442. \\u043d\\u0435 \\u043f\\u0430\\u0445\\u043d\\u0435\\u0442. \\u0412 \\u043e\\u0431\\u0449\\u0435\\u043c \\u0437\\u0430 \\u0442\\u0430\\u043a\\u0438\\u0435 \\u0434\\u0435\\u043d\\u044c\\u0433\\u0438 \\u0431\\u043e\\u043b\\u0435\\u0435 \\u043c\\u0435\\u043d\\u0435\\u0435.. \\u0440\\u0435\\u043a\\u043e\\u043c\\u0435\\u043d\\u0434\\u0443\\u044e \\u0431\\u0440\\u0430\\u0442\\u044c \\u043d\\u0430 \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440 \\u043f\\u043e\\u0431\\u043e\\u043b\\u044c\\u0448\\u0435.\",\n          \"\\u0448\\u0442\\u0430\\u043d\\u044b \\u043e\\u0442\\u0441\\u0442\\u043e\\u0439. \\u043d\\u0430 \\u0441\\u0442\\u0430\\u043d\\u0434\\u0430\\u0440\\u0442\\u043d\\u043e\\u0439 \\u0444\\u0438\\u0433\\u0443\\u0440\\u0435 \\u0441\\u0438\\u0434\\u044f\\u0442 \\u0441\\u043e\\u0432\\u0435\\u0440\\u0448\\u0435\\u043d\\u043d\\u043e \\u043d\\u0435 \\u043a\\u0430\\u043a \\u043d\\u0430 \\u0444\\u043e\\u0442\\u043e.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"pseudo_label_rubert\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3,\n        \"samples\": [\n          \"unknown\",\n          \"\\u043e\\u0434\\u0435\\u0436\\u0434\\u0430\",\n          \"\\u043d\\u0435\\u0442 \\u0442\\u043e\\u0432\\u0430\\u0440\\u0430\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"confidence_rubert\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.16182614711545595,\n        \"min\": 0.4170325601580799,\n        \"max\": 0.9763973891824372,\n        \"num_unique_values\": 50,\n        \"samples\": [\n          0.9265550002218724,\n          0.9643183993032102,\n          0.6842835060066749\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}","type":"dataframe","variable_name":"sample_df"}
```
:::
:::

::: {.cell .code execution_count="12" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="Ex0Gch5Lh4mk" outputId="000e04fd-73be-4df0-a9ad-e20e2f40f14f"}
``` python
print((train['pseudo_label_rubert'] == 'unknown').sum())
train['pseudo_label_rubert'].unique()
```

::: {.output .stream .stdout}
    286
:::

::: {.output .execute_result execution_count="12"}
    array(['unknown', 'нет товара', 'одежда'], dtype=object)
:::
:::

::: {.cell .code execution_count="13" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="zdkoFGqryaPi" outputId="3f4b314f-b8e4-4b4a-fea0-5f3c381e5ff2"}
``` python
print(train.shape)
new_train = train[(train['pseudo_label_rubert']) != 'unknown']
print(new_train.shape)
```

::: {.output .stream .stdout}
    (1692, 3)
    (1406, 3)
:::
:::

::: {.cell .code execution_count="14" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":36}" id="Wi0YsK06nfxO" outputId="f87c512c-6a46-4947-e079-d571fda2833e"}
``` python
#train[train['pseudo_label_rubert'] == 'unknown'].to_excel('candidates.xlsx')

"""
это мы получили excel-файл, где вручную разметили те объекты, в которых
класс был 'unknown'
"""
```

::: {.output .execute_result execution_count="14"}
``` json
{"type":"string"}
```
:::
:::

::: {.cell .code execution_count="15" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":458}" id="S0qQz5d1vn_W" outputId="5f2fabf3-0cda-4fed-b218-bc39bdb5d675"}
``` python
new_labels = pd.read_excel("/content/drive/MyDrive/NLP_CASE_FINAL/candidates.xlsx")
train_after_hand_classification = pd.concat([new_labels, new_train], ignore_index=True)
print(train_after_hand_classification['pseudo_label_rubert'].unique())
del train_after_hand_classification['Unnamed: 0']
train_after_hand_classification
```

::: {.output .stream .stdout}
    ['нет товара' 'одежда' 'текстиль' 'украшения и аксессуары'
     'товары для детей']
:::

::: {.output .execute_result execution_count="15"}
``` json
{"summary":"{\n  \"name\": \"train_after_hand_classification\",\n  \"rows\": 1692,\n  \"fields\": [\n    {\n      \"column\": \"text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 1692,\n        \"samples\": [\n          \"\\u041a\\u0430\\u0447\\u0435\\u0441\\u0442\\u0432\\u043e \\u0442\\u043a\\u0430\\u043d\\u0438 \\u0445\\u043e\\u0440\\u043e\\u0448\\u0435\\u0435.\\u0412 \\u0431\\u043b\\u0443\\u0437\\u043a\\u0435 \\u0435\\u0441\\u0442\\u044c 1 \\u0431\\u043e\\u043b\\u044c\\u0448\\u043e\\u0439 \\u043c\\u0438\\u043d\\u0443\\u0441 \\u043d\\u0435 \\u0441\\u0438\\u043c\\u0435\\u0442\\u0440\\u0438\\u0447\\u043d\\u044b \\u0441\\u0434\\u0435\\u043b\\u0430\\u043d\\u044b \\u0441\\u043a\\u043b\\u0430\\u0434\\u043a\\u0438 .\\u0414\\u043e\\u043b\\u0436\\u043d\\u044b \\u0431\\u044b\\u0442\\u044c \\u043f\\u043e \\u0446\\u0435\\u043d\\u0442\\u0440\\u0443 ,\\u0430 \\u043e\\u043d\\u0438 \\u0441 \\u0431\\u043e\\u043a\\u0443 \\u0442.\\u0435.\\u0431\\u0440\\u0430\\u043a.\\u041f\\u0440\\u043e\\u0434\\u043e\\u0432\\u0435\\u0446 \\u043f\\u043e \\u043e\\u0431\\u0449\\u0435\\u043d\\u0438\\u044e \\u0445\\u043e\\u0440\\u043e\\u0448\\u0438\\u0439.\\u041f\\u043e \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440\\u0443 \\u0438\\u0434\\u0435\\u0430\\u043b\\u044c\\u043d\\u043e.\",\n          \"\\u041a\\u0430\\u0447\\u0435\\u0441\\u0442\\u0432\\u043e \\u043e\\u0447\\u0435\\u043d\\u044c \\u0434\\u0430\\u0436\\u0435 \\u043d\\u0435\\u043f\\u043b\\u043e\\u0445\\u043e\\u0435, \\u0447\\u0442\\u043e \\u0445\\u043e\\u0442\\u0435\\u043b\\u0430, \\u0441\\u0438\\u043d\\u0442\\u0435\\u0442\\u0438\\u043a\\u0430 \\u043d\\u0435\\u043c\\u043d\\u043e\\u0433\\u043e \\u043f\\u043e\\u0445\\u043e\\u0436\\u0430 \\u043d\\u0430 \\u0437\\u0430\\u043c\\u0448\\u0443, \\u041d\\u043e, \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440 \\u043f\\u0440\\u043e\\u0441\\u0442\\u043e \\u043a\\u0430\\u043f\\u0435\\u043b\\u044e\\u0448\\u0447\\u043d\\u044b\\u0439, \\u043d\\u0430 44 \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440 XXL \\u0435\\u043b\\u0435, \\u0435\\u043b\\u0435 \\u043f\\u043e\\u0434\\u043e\\u0448\\u0451\\u043b. \\u042f \\u0437\\u0430\\u043a\\u0430\\u0437\\u0430\\u043b\\u0430 3xL, \\u0430 \\u043f\\u0440\\u0438\\u0441\\u043b\\u0430\\u043b\\u0438 2xl, \\u043e\\u0442\\u043a\\u0440\\u044b\\u043b\\u0430 \\u0441\\u043f\\u043e\\u0440, \\u043d\\u0438\\u043a\\u0430\\u043a \\u043d\\u0435 \\u0440\\u0435\\u0448\\u0438\\u043b\\u0438 \\u043f\\u0440\\u043e\\u0431\\u043b\\u0435\\u043c\\u0443. \\u041e\\u0447\\u0435\\u043d\\u044c \\u043e\\u0431\\u0438\\u0434\\u043d\\u043e.\",\n          \"\\u0421\\u0443\\u043f\\u0435\\u0440-\\u043f\\u0443\\u043f\\u0435\\u0440! \\u041f\\u0440\\u0438\\u0448\\u043b\\u043e \\u0437\\u0430 17 \\u0434\\u043d\\u0435\\u0439 \\u043f\\u043e \\u0431\\u0435\\u0441\\u043f\\u043b\\u0430\\u0442\\u043d\\u043e\\u0439 \\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u043a\\u0435 !!! \\u041e\\u0447\\u0435\\u043d\\u044c \\u043f\\u043e\\u043d\\u0440\\u0430\\u0432\\u0438\\u043b\\u043e\\u0441\\u044c \\u043a\\u0430\\u043a \\u0441\\u043c\\u043e\\u0442\\u0440\\u0438\\u0442\\u0441\\u044f \"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"pseudo_label_rubert\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"\\u043e\\u0434\\u0435\\u0436\\u0434\\u0430\",\n          \"\\u0442\\u043e\\u0432\\u0430\\u0440\\u044b \\u0434\\u043b\\u044f \\u0434\\u0435\\u0442\\u0435\\u0439\",\n          \"\\u0442\\u0435\\u043a\\u0441\\u0442\\u0438\\u043b\\u044c\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"confidence_rubert\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.16644255228675556,\n        \"min\": 0.3243811997801506,\n        \"max\": 0.9890827953140618,\n        \"num_unique_values\": 1692,\n        \"samples\": [\n          0.9800335346863048,\n          0.939159827256825,\n          0.791252609063483\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}","type":"dataframe","variable_name":"train_after_hand_classification"}
```
:::
:::

::: {.cell .markdown id="RRsqpOvc0qdF"}
## На данном этапе мы разметили train, теперь будем приступать к test
:::

::: {.cell .code execution_count="16" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":1000}" id="X_3Rky-Y0vK5" outputId="e4a095cb-f11e-4288-80aa-dbf4e85819a1"}
``` python
embeddings_test = get_embeddings(test["text"].tolist())
embeddings_new_train = get_embeddings(new_train['text'].tolist())

clf = CatBoostClassifier(
    iterations=800,
    depth=7,
    learning_rate=0.05,
    loss_function="MultiClass",
    eval_metric="TotalF1",
    random_seed=42,
    verbose=100
)

clf.fit(embeddings_new_train, new_train["pseudo_label_rubert"])
pseudo_labels_test = clf.predict(embeddings_test).ravel()
proba_test = clf.predict_proba(embeddings_test)
max_proba_test = np.max(proba_test, axis=1)

threshold_test = 0.75
pseudo_labels_test[max_proba_test < threshold_test] = "unknown"

test["pseudo_label_rubert"] = pseudo_labels_test
test["confidence_rubert"] = max_proba_test

pd.set_option('display.max_colwidth', None)
sample_df_test = test.sample(n=50, random_state=42)[["text", "pseudo_label_rubert", "confidence_rubert"]]
sample_df_test.reset_index(drop=True, inplace=True)
sample_df_test
```

::: {.output .stream .stderr}
    Encoding: 100%|██████████| 228/228 [00:23<00:00,  9.84it/s]
    Encoding: 100%|██████████| 44/44 [00:04<00:00,  9.67it/s]
:::

::: {.output .stream .stdout}
    0:	learn: 0.9451745	total: 826ms	remaining: 11m
    100:	learn: 0.9957040	total: 1m 1s	remaining: 7m 3s
    200:	learn: 1.0000000	total: 2m 3s	remaining: 6m 7s
    300:	learn: 1.0000000	total: 3m 3s	remaining: 5m 4s
    400:	learn: 1.0000000	total: 4m 4s	remaining: 4m 3s
    500:	learn: 1.0000000	total: 5m 5s	remaining: 3m 2s
    600:	learn: 1.0000000	total: 6m 5s	remaining: 2m 1s
    700:	learn: 1.0000000	total: 7m 5s	remaining: 1m
    799:	learn: 1.0000000	total: 8m 6s	remaining: 0us
:::

::: {.output .execute_result execution_count="16"}
``` json
{"summary":"{\n  \"name\": \"sample_df_test\",\n  \"rows\": 50,\n  \"fields\": [\n    {\n      \"column\": \"text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 50,\n        \"samples\": [\n          \"\\u041c\\u0430\\u043b\\u043e\\u043c\\u0435\\u0440\\u043a\\u0430 ... \\u043d\\u0435 \\u0441\\u043e\\u0432\\u043f\\u0430\\u0434\\u0430\\u0435\\u0442 \\u0441 \\u0442\\u0430\\u0431\\u043b\\u0438\\u0446\\u0435\\u0439...\",\n          \"\\u0441\\u043f\\u0430\\u0441\\u0438\\u0431\\u043e, \\u043a\\u0443\\u0440\\u0442\\u043a\\u0430 \\u043e\\u0447\\u0435\\u043d\\u044c \\u043f\\u043e\\u043d\\u0440\\u0430\\u0432\\u0438\\u043b\\u0430\\u0441\\u044c, \\u043f\\u043e \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440\\u0443 \\u043f\\u043e\\u0434\\u043e\\u0448\\u043b\\u0430. \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440 \\u041c \\u0441\\u043e\\u043e\\u0442\\u0432\\u0435\\u0442\\u0441\\u0442\\u0432\\u0443\\u0435\\u0442 \\u043d\\u0430\\u0448\\u0435\\u043c\\u0443 42. \\u043d\\u0430 44 \\u0431\\u0443\\u0434\\u0435\\u0442 \\u043c\\u0430\\u043b\\u043e\\u0432\\u0430\\u0442\\u0430. \\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u043a\\u0430 \\u0434\\u043e \\u041a\\u0440\\u0430\\u0441\\u043d\\u043e\\u0434\\u0430\\u0440\\u0441\\u043a\\u043e\\u0433\\u043e \\u043a\\u0440\\u0430\\u044f \\u0433\\u0434\\u0435 \\u0442\\u043e \\u043c\\u0435\\u0441\\u044f\\u0446 \\u0421\\u043f\\u0430\\u0441\\u0438\\u0431\\u043e \\u043e\\u0442\\u0434\\u0435\\u043b\\u044c\\u043d\\u043e\\u0435 \\u0437\\u0430 \\u0440\\u0435\\u0437\\u0438\\u043d\\u043e\\u0447\\u043a\\u0443 \\u043c\\u0435\\u043b\\u043e\\u0447\\u044c \\u0430 \\u043e\\u0447\\u0435\\u043d\\u044c \\u043f\\u0440\\u0438\\u044f\\u0442\\u043d\\u043e...\",\n          \"kofta ne takaia kak na kartinke,tonkaia,no za takuiu cenu ne jalko)) spasibo prodavcu prishlo vse bistro)))\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"pseudo_label_rubert\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3,\n        \"samples\": [\n          \"\\u043e\\u0434\\u0435\\u0436\\u0434\\u0430\",\n          \"\\u043d\\u0435\\u0442 \\u0442\\u043e\\u0432\\u0430\\u0440\\u0430\",\n          \"unknown\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"confidence_rubert\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.07017935519677082,\n        \"min\": 0.6777136486141246,\n        \"max\": 0.9999929523447877,\n        \"num_unique_values\": 50,\n        \"samples\": [\n          0.917597701716806,\n          0.9999843533326077,\n          0.9971376742324359\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}","type":"dataframe","variable_name":"sample_df_test"}
```
:::
:::

::: {.cell .code execution_count="17" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="TIaP5LwF46CV" outputId="e855c944-5a8f-41ff-b900-122d0ae579fd"}
``` python
print((test['pseudo_label_rubert'] == 'unknown').sum())
print(test['pseudo_label_rubert'].unique())
```

::: {.output .stream .stdout}
    337
    ['одежда' 'нет товара' 'unknown']
:::
:::

::: {.cell .code execution_count="18" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":36}" id="_Dz4GeyUFqfQ" outputId="e8478853-7e3d-4e41-bae9-8510f5834056"}
``` python
#test[test['pseudo_label_rubert'] == 'unknown'].to_excel('/content/drive/MyDrive/NLP_case/candidates_2_labeled.xlsx')

"""
это мы получили excel-файл, где вручную разметили те объекты, в которых
класс был 'unknown'
"""
```

::: {.output .execute_result execution_count="18"}
``` json
{"type":"string"}
```
:::
:::

::: {.cell .code execution_count="19" collapsed="true" id="yynNjkvgKlyB"}
``` python
new_test = test[test['pseudo_label_rubert'] != 'unknown']
```
:::

::: {.cell .code execution_count="20" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":441}" id="hcdUdKhJKck9" outputId="64969f74-347d-4f77-98e8-522778d3bd7f"}
``` python
new_labels_test = pd.read_excel("/content/drive/MyDrive/NLP_CASE_FINAL/candidates_2_labeled.xlsx")
test_after_hand_classification = pd.concat([new_labels_test, new_test], ignore_index=True)
del test_after_hand_classification['Unnamed: 0']
test_after_hand_classification
```

::: {.output .execute_result execution_count="20"}
``` json
{"summary":"{\n  \"name\": \"test_after_hand_classification\",\n  \"rows\": 7276,\n  \"fields\": [\n    {\n      \"column\": \"text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 7276,\n        \"samples\": [\n          \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u0430\\u044f \\u043a\\u0443\\u0440\\u0442\\u043a\\u0430. \\u0414\\u043e\\u0448\\u043b\\u0430 \\u0437\\u0430 17 \\u0434\\u043d\\u0435\\u0439. \\u0412\\u0441\\u0435 \\u043f\\u043e \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440\\u0443. \\u0421\\u043c\\u043e\\u0442\\u0440\\u0438\\u0442\\u0441\\u044f \\u0445\\u043e\\u0440\\u043e\\u0448\\u043e. \\u0412 \\u043f\\u043e\\u0434\\u0430\\u0440\\u043e\\u043a \\u0440\\u0435\\u0437\\u0438\\u043d\\u043a\\u0430 \\u0434\\u043b\\u044f \\u0432\\u043e\\u043b\\u043e\\u0441. \\u0421\\u043f\\u0430\\u0441\\u0438\\u0431\\u043e \\u043f\\u0440\\u043e\\u0434\\u0430\\u0432\\u0446\\u0443.\",\n          \"\\u041d\\u0430\\u043f\\u0438\\u0441\\u0430\\u043d\\u043e \\u0447\\u0442\\u043e \\u043e\\u043d \\u0434\\u043b\\u0438\\u043d\\u043d\\u044b\\u0439 \\u0430 \\u043e\\u043d \\u0443\\u043a\\u043e\\u0440\\u043e\\u0447\\u0435\\u043d\\u043d\\u044b\\u0439,\\u0438 \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440\\u0430\\u043c \\u0432\\u043e\\u043e\\u0431\\u0449\\u0435 \\u043d\\u0435 \\u0441\\u043e\\u043e\\u0442\\u0432\\u0435\\u0442\\u0441\\u0442\\u0432\\u0443\\u0435\\u0442...\",\n          \"\\u042f \\u0437\\u0430\\u043a\\u0430\\u0437\\u0430\\u043b\\u0430 \\u0434\\u0440\\u0443\\u0433\\u043e\\u0439 \\u0444\\u0430\\u0441\\u043e\\u043d,\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"pseudo_label_rubert\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"\\u043d\\u0435\\u0442 \\u0442\\u043e\\u0432\\u0430\\u0440\\u0430\",\n          \"\\u0442\\u043e\\u0432\\u0430\\u0440\\u044b \\u0434\\u043b\\u044f \\u0434\\u0435\\u0442\\u0435\\u0439\",\n          \"\\u0442\\u0435\\u043a\\u0441\\u0442\\u0438\\u043b\\u044c\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"confidence_rubert\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.08432932186756398,\n        \"min\": 0.5011866470891903,\n        \"max\": 0.9999942787168382,\n        \"num_unique_values\": 7272,\n        \"samples\": [\n          0.997895074264428,\n          0.9999715786371074,\n          0.9619265529874422\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}","type":"dataframe","variable_name":"test_after_hand_classification"}
```
:::
:::

::: {.cell .markdown id="y1OzKkPrPuYs"}
# Как итог, у нас есть размеченные с помощью **RuBERT + CatBoost** train, val, test. Теперь хочется узнать, насколько мы правильно все сделали, для этого воспользуемся **joeddav/xlm-roberta-large-xnli** {#как-итог-у-нас-есть-размеченные-с-помощью-rubert--catboost-train-val-test-теперь-хочется-узнать-насколько-мы-правильно-все-сделали-для-этого-воспользуемся-joeddavxlm-roberta-large-xnli}
:::

::: {.cell .code execution_count="21" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":266,\"referenced_widgets\":[\"c41542737a394a9fb7b6b5fde74cdad6\",\"3382c1f0bf61454795e30f0c59ecef7f\",\"cbe20cd9c29146e492a563859480f123\",\"a3f5899b70204faf94d04ce8457cb141\",\"aca4a3e4f45741f6838ed0615db70127\",\"8d57d2376e0b462691c4e23506093b7d\",\"2dde06f1d3b144a09e936c04d5de4f48\",\"f891f71312b14c51a014fc3e05add3a2\",\"5add427adcdb42f1a581c13f71e70069\",\"1f5cf6cd71b749c689682a8d7049074c\",\"78acf5556e804ff2af33d15186a58d68\",\"412c4c80893c4e88ad3726917820f64e\",\"a71dede6d2274f779f3fe8970bfc9478\",\"daf443d441924d109caf724aeb44d086\",\"0b82a4ee13024df5ad273bc7c383b5e3\",\"5200b26bb19b4ff884070678878886de\",\"5736f03587404ff29ee5ebbd9f0dbbe6\",\"980f91b4f71f4d648e3c5da59bbc0987\",\"8ecede5a2732458f8d86c01f7a2d353f\",\"2ad31e03da334b41bb278d8236105a89\",\"91ad9db5e34c494e978a95453f34fb4b\",\"a594c57e99ab41a49e365eb542702bbc\",\"c18afabb3dfa40308dbe19e2dad55bf4\",\"efaa5bc01b8c43a493eb7e4f991c63b3\",\"6b7b693cb64e4e539cde8ba403ef7504\",\"d26071709f33473a9a39858a829febec\",\"ae8a2c977c8548a58725b1fa2700b07e\",\"8d972cb129b2460b829a84d17b0207ae\",\"19fe740fec3844a6b309c24ee2946f6d\",\"fd8adeb8dc94489496e6d36dbb90234f\",\"aed1227721f84cd196232dd017c3b4e1\",\"a8663f1a212348e2bcd47d38ade8fbfd\",\"775652227abe420eab930dc26de3895a\",\"7416163fdde4402fb45abe866eb09c2b\",\"008b664059424c97b0e5d5492e3cbdfb\",\"9c3eb70aa33c450086ffbd7796e25a0a\",\"664697cbfe554c94b9dea9f2ff065c63\",\"466b531512314a60b73f38084c19edf0\",\"5f8ba7b861fa4611981defd4ee46ca8f\",\"d1ba5e5346d94920bb17fecff7b8a0e2\",\"a7d679170ff34eb985fa958243719875\",\"698aa1e3861e44b1bb84278714d77de3\",\"5298fe0ba29f4580896a5f3bce64ebc7\",\"781766d14cb14fa39636645f57f4cafb\",\"ffac6e99afa34044a550292cbdafe593\",\"a4a93bb4c3d54e5997ae79c944216a8d\",\"c445f39e094d4bc39bfc207fdd88c88e\",\"78f49e5347b4488c892ebbd109fb8ec1\",\"66a01127eee04a9aa0a73885162958b0\",\"dea297feda91424c96614795659f025a\",\"84aac9feab404ac8a20ebc22063afaba\",\"2a2afff6f3344fd686e4f47484cde10b\",\"143362d404c449f7b130860c59ddcfdf\",\"69f8fcb03fc8448698929699c21bc487\",\"18b8ffaac83e457eab6a37f397611bbe\"]}" collapsed="true" id="LZ1B2R7VQCeA" outputId="5798472e-979d-4af4-cf14-e80e38c1a273"}
``` python
from transformers import pipeline

device = 0 if torch.cuda.is_available() else -1
classifier = pipeline(
    "zero-shot-classification",
    model="joeddav/xlm-roberta-large-xnli",
    device=device
)
```

::: {.output .display_data}
``` json
{"model_id":"c41542737a394a9fb7b6b5fde74cdad6","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"412c4c80893c4e88ad3726917820f64e","version_major":2,"version_minor":0}
```
:::

::: {.output .stream .stderr}
    Some weights of the model checkpoint at joeddav/xlm-roberta-large-xnli were not used when initializing XLMRobertaForSequenceClassification: ['roberta.pooler.dense.bias', 'roberta.pooler.dense.weight']
    - This IS expected if you are initializing XLMRobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
    - This IS NOT expected if you are initializing XLMRobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
:::

::: {.output .display_data}
``` json
{"model_id":"c18afabb3dfa40308dbe19e2dad55bf4","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"7416163fdde4402fb45abe866eb09c2b","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"ffac6e99afa34044a550292cbdafe593","version_major":2,"version_minor":0}
```
:::

::: {.output .stream .stderr}
    Device set to use cuda:0
:::
:::

::: {.cell .code execution_count="22" id="fAmphzPPQ4qe"}
``` python
categories = [
    "обувь",
    "одежда",
    "текстиль",
    "товары для детей",
    "украшения и аксессуары",
    "нет товара"
]
```
:::

::: {.cell .code execution_count="23" id="YUqH7HxsQ9Iv"}
``` python
def classify_text(text, threshold=0.6):
    res = classifier(text, candidate_labels=categories, multi_label=False)
    top_label = res['labels'][0]
    top_score = res['scores'][0]
    if top_score < threshold:
        return "unknown", top_score
    return top_label, top_score
```
:::

::: {.cell .code execution_count="24" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":424}" collapsed="true" id="tp7Vms94zCr3" outputId="905a5a3c-63b8-43c8-c067-f226346232d9"}
``` python
new_valid = valid.copy()
new_valid.rename(columns={'labels': 'pseudo_label_rubert'}, inplace=True)
new_valid
```

::: {.output .execute_result execution_count="24"}
``` json
{"summary":"{\n  \"name\": \"new_valid\",\n  \"rows\": 126,\n  \"fields\": [\n    {\n      \"column\": \"text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 126,\n        \"samples\": [\n          \"\\u0412 \\u0446\\u0435\\u043b\\u043e\\u043c \\u043f\\u043e\\u043d\\u0440\\u0430\\u0432\\u0438\\u043b\\u0441\\u044f\\uff01  \\u0441\\u0435\\u043b \\u043d\\u0430 48 \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440 \\u0438\\u0434\\u0435\\u0430\\u043b\\u044c\\u043d\\u043e. \\u0415\\u0434\\u0438\\u043d\\u0441\\u0442\\u0432\\u0435\\u043d\\u043d\\u0438\\u0439 \\u043c\\u0438\\u043d\\u0443\\u0441 - \\u043f\\u0440\\u0438 \\u043f\\u0435\\u0440\\u0432\\u043e\\u0439 \\u0436\\u0435 \\u0441\\u0442\\u0438\\u0440\\u043a\\u0435 \\u043b\\u0438\\u043d\\u044f\\u043b \\u0441\\u0438\\u043b\\u044c\\u043d\\u043e, \\u0442\\u0430\\u043a \\u0447\\u0442\\u043e \\u0441\\u043e\\u0432\\u0435\\u0442\\u0443\\u044e \\u0441\\u0442\\u0438\\u0440\\u0430\\u0442\\u044c \\u043e\\u0442\\u0434\\u0435\\u043b\\u044c\\u043d\\u043e \\u0432\\u0440\\u0443\\u0447\\u043d\\u0443\\u044e.\",\n          \"\\u0443\\u0440\\u0430! \\u043e\\u0431\\u043e\\u0436\\u0430\\u044e \\u044d\\u0442\\u043e\\u0442 \\u0434\\u0436\\u0435\\u043c\\u043f\\u0435\\u0440! \\u0443 \\u043c\\u0435\\u043d\\u044f \\u0442\\u0430\\u043a\\u043e\\u0439 \\u0435\\u0449\\u0435 \\u0441\\u0435\\u0440\\u044b\\u0439 \\u0435\\u0441\\u0442\\u044c. \\u043e\\u0447\\u0435\\u043d\\u044c \\u043a\\u0440\\u0430\\u0441\\u0438\\u0432\\u044b\\u0439 \\u0438 \\u0442\\u0435\\u043f\\u043b\\u044b\\u0439! \\u043e\\u0442\\u0434\\u0435\\u043b\\u044c\\u043d\\u043e\\u0435 \\u0441\\u043f\\u0430\\u0441\\u0438\\u0431\\u043e \\u043f\\u0440\\u043e\\u0434\\u0430\\u0432\\u0446\\u0443 \\u0437\\u0430 \\u0442\\u043e, \\u0447\\u0442\\u043e \\u043d\\u0430\\u0448\\u0435\\u043b \\u0434\\u043b\\u044f \\u043c\\u0435\\u043d\\u044f \\u043e\\u0434\\u043d\\u0443 \\u0448\\u0442\\u0443\\u043a\\u0443, \\u043f\\u043e\\u0442\\u043e\\u043c\\u0443 \\u0447\\u0442\\u043e \\u0438\\u0437\\u043d\\u0430\\u0447\\u0430\\u043b\\u044c\\u043d\\u043e \\u0431\\u044b\\u043b\\u0430 \\u0438\\u043d\\u0444\\u0430, \\u0447\\u0442\\u043e \\u0442\\u043e\\u0432\\u0430\\u0440 \\u0437\\u0430\\u043a\\u043e\\u043d\\u0447\\u0438\\u043b\\u0441\\u044f! \\u0441\\u043f\\u0430\\u0441\\u0438\\u0431\\u043e!\",\n          \"\\u0417\\u0434\\u0440\\u0430\\u0432\\u0441\\u0442\\u0432\\u0443\\u0439\\u0442\\u0435.\\u0428\\u0430\\u043f\\u043a\\u0430 \\u043d\\u0435 \\u043f\\u043b\\u043e\\u0445\\u0430\\u044f.\\u0422\\u043e\\u043d\\u043a\\u0430\\u044f \\u0438 \\u0441\\u043b\\u0430\\u0431\\u0430\\u044f \\u0440\\u0435\\u0437\\u0438\\u043d\\u043a\\u0430.\\u041f\\u0440\\u0438 \\u043f\\u0435\\u0440\\u0432\\u043e\\u0439 \\u0436\\u0435 \\u043d\\u043e\\u0441\\u043a\\u0435 \\u0441\\u0438\\u043b\\u044c\\u043d\\u043e \\u0440\\u0430\\u0441\\u0442\\u044f\\u043d\\u0443\\u043b\\u0430\\u0441\\u044c.\\u0428\\u0432\\u044b \\u043d\\u0435 \\u0440\\u043e\\u0432\\u043d\\u044b\\u0435 \\u0438 \\u0432\\u044b\\u0442\\u043e\\u0447\\u043a\\u0438 \\u0441\\u0437\\u0430\\u0434\\u0438 \\u0440\\u0430\\u0441\\u043f\\u043e\\u043b\\u043e\\u0436\\u0435\\u043d\\u044b \\u043d\\u0435 \\u0440\\u043e\\u0432\\u043d\\u043e.\\u041f\\u0440\\u0438\\u0448\\u043b\\u043e\\u0441\\u044c \\u043f\\u0435\\u0440\\u0435\\u0448\\u0438\\u0432\\u0430\\u0442\\u044c.\\u041c\\u043e\\u0436\\u0435\\u0442 \\u044d\\u0442\\u043e \\u0431\\u0440\\u0430\\u043a.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"pseudo_label_rubert\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 6,\n        \"samples\": [\n          \"\\u043e\\u0434\\u0435\\u0436\\u0434\\u0430\",\n          \"\\u043d\\u0435\\u0442 \\u0442\\u043e\\u0432\\u0430\\u0440\\u0430\",\n          \"\\u0443\\u043a\\u0440\\u0430\\u0448\\u0435\\u043d\\u0438\\u044f \\u0438 \\u0430\\u043a\\u0441\\u0435\\u0441\\u0441\\u0443\\u0430\\u0440\\u044b\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}","type":"dataframe","variable_name":"new_valid"}
```
:::
:::

::: {.cell .code execution_count="25" id="1Zxgq3JBRc9M"}
``` python
def classify_dataframe(df, text_column="text", threshold=0):
    labels = []
    scores = []
    for text in tqdm(df[text_column].tolist(), desc="Classifying"):
        label, score = classify_text(text, threshold=threshold)
        labels.append(label)
        scores.append(score)
    df["pred_label"] = labels
    df["confidence"] = scores
    df['agree?'] = (df['pred_label'] == df['pseudo_label_rubert'])

    return df
```
:::

::: {.cell .code execution_count="26" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="ueG-1wQjsW85" outputId="5c43e419-d4b8-4a6d-8b40-7644265ab40a"}
``` python
train_after_hand_classification = classify_dataframe(train_after_hand_classification, text_column="text", threshold=0.6)
new_valid = classify_dataframe(new_valid, text_column="text", threshold=0.6)
test_after_hand_classification  = classify_dataframe(test_after_hand_classification, text_column="text", threshold=0.6)
```

::: {.output .stream .stderr}
    Classifying:   1%|          | 9/1692 [00:01<02:47, 10.05it/s]You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
    Classifying: 100%|██████████| 1692/1692 [03:01<00:00,  9.30it/s]
    Classifying: 100%|██████████| 126/126 [00:13<00:00,  9.31it/s]
    Classifying: 100%|██████████| 7276/7276 [13:02<00:00,  9.29it/s]
:::
:::

::: {.cell .code execution_count="27" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="sv8etjoR3DrF" outputId="d8cff7c8-3e5c-4775-bd02-05fb8db079fc"}
``` python
print(train_after_hand_classification['agree?'].value_counts())
print(new_valid['agree?'].value_counts())
print(test_after_hand_classification['agree?'].value_counts())

#как мы видим, все плохо
```

::: {.output .stream .stdout}
    agree?
    False    1050
    True      642
    Name: count, dtype: int64
    agree?
    False    92
    True     34
    Name: count, dtype: int64
    agree?
    False    4628
    True     2648
    Name: count, dtype: int64
:::
:::

::: {.cell .markdown id="a4HMxSuzRmlK"}
\# Теперь сделаем двойную проверку: будем брать в качестве меток то, что
описано в ячейках
:::

::: {.cell .code execution_count="28" id="D8G7HtaDa9RK"}
``` python
#train_after_hand_classification[train_after_hand_classification['pseudo_label_ensemble_final'] == 'текстиль'] #оставляем только предсказания по rubert + cb
#train_after_hand_classification[train_after_hand_classification['pred_label'] == 'текстиль'] #там, где не согласен, берем xlmroberta
#train_after_hand_classification[train_after_hand_classification['pred_label'] == 'обувь'] #обуви нет, xlmroberta предсказывает брехню, поэтому по обуви берем rubert + cb
#train_after_hand_classification[train_after_hand_classification['pred_label'] == 'товары для детей'] #лучше предсказывает rubert
#train_after_hand_classification[train_after_hand_classification['pseudo_label_ensemble_final'] == 'товары для детей'] #лучше предсказывает rubert
#train_after_hand_classification[train_after_hand_classification['pseudo_label_ensemble_final'] == 'украшения и аксессуары'] #лучше предсказывает rubert
#train_after_hand_classification[train_after_hand_classification['pred_label'] == 'украшения и аксессуары'] #берем rubert + cb
#train_after_hand_classification[train_after_hand_classification['pseudo_label_ensemble_final'] == 'одежда'] #лучше предсказывает rubert + cb
#train_after_hand_classification[train_after_hand_classification['pseudo_label_ensemble_final'] == 'нет товара'] #лучше предсказывает rubert + cb
```
:::

::: {.cell .markdown id="ChMzDXX6lX1w"}
Сверху можно поудалять \'#\', чтобы посмотреть, почему я сделал такие
выводы. Теперь на основе того, что я вывел, разметим train
:::

::: {.cell .code execution_count="29" id="1bQSc4CARqhO"}
``` python
final_labels_train = []

for _, row in train_after_hand_classification.iterrows():
    rubert = row['pseudo_label_rubert']
    xlm = row['pred_label']
    agree = row['agree?']

    if rubert == xlm:
        final_labels_train.append(rubert)
    else:
        if 'текстиль' in [rubert, xlm]:
            if agree == False:
                final_labels_train.append(xlm)
            else:
                final_labels_train.append(rubert)
        elif 'товары для детей' in [rubert, xlm]:
            # Всегда берём RuBERT+CB
            final_labels_train.append(rubert)
        else:
            # Остальные классы — берём RuBERT+CB
            final_labels_train.append(rubert)

train_after_hand_classification['pseudo_label_ensemble_final'] = final_labels_train
```
:::

::: {.cell .code execution_count="30" id="jxa6qA3CmSzR"}
``` python
#test_after_hand_classification[test_after_hand_classification['pseudo_label_ensemble_final'] == 'текстиль'] #оставляем rubert + cb
#test_after_hand_classification[test_after_hand_classification['pred_label'] == 'текстиль'] #берем только руберту
#test_after_hand_classification[test_after_hand_classification['pseudo_label_ensemble_final'] == 'обувь'] #нет данных
#test_after_hand_classification[test_after_hand_classification['pred_label'] == 'обувь'] #берем rubert + cb, поскольку xlmroberta реагирует на "носки" и "чулки" как на обувь
#test_after_hand_classification[test_after_hand_classification['pseudo_label_ensemble_final'] == 'товары для детей'] #можем брать и руберту, и xlmroberta
#test_after_hand_classification[test_after_hand_classification['pred_label'] == 'товары для детей'] #берем только руберту
#test_after_hand_classification[test_after_hand_classification['pseudo_label_ensemble_final'] == 'украшения и аксессуары'] #ничего нет
#test_after_hand_classification[test_after_hand_classification['pred_label'] == 'украшения и аксессуары'] #берем xlmroberta
#test_after_hand_classification[test_after_hand_classification['pseudo_label_ensemble_final'] == 'нет товара'] #берем rubert + cb
#test_after_hand_classification[test_after_hand_classification['pred_label'] == 'нет товара'] #берем rubert + cb
#для одежды берем rubert + cb
```
:::

::: {.cell .code execution_count="31" id="WeNfDxBSqioY"}
``` python
final_labels_test = []

for _, row in test_after_hand_classification.iterrows():
    rubert = row['pseudo_label_rubert']
    xlm = row['pred_label']
    agree = row['agree?']

    if rubert == xlm:
        final_labels_test.append(rubert)
    else:
        if 'текстиль' in [rubert, xlm]:
            final_labels_test.append(rubert)
        elif 'обувь' in [rubert, xlm]:
            final_labels_test.append(rubert)
        elif 'товары для детей' in [rubert, xlm]:
            final_labels_test.append(rubert)
        elif 'украшения и аксессуары' in [rubert, xlm]:
            final_labels_test.append(xlm)
        elif 'нет товара' in [rubert, xlm]:
            final_labels_test.append(rubert)
        else:
            final_labels_test.append(rubert)

test_after_hand_classification['pseudo_label_ensemble_final'] = final_labels_test
```
:::

::: {.cell .code execution_count="32" id="dcaG71GNqqVq"}
``` python
train_after_hand_classification.to_csv('FINAL_TRAIN.csv')
test_after_hand_classification.to_csv('FINAL_TEST.csv')
new_valid.to_csv('FINAL_VALID.csv')
```
:::

::: {.cell .markdown id="kgIK_y_iCKU_"}
# Подготовка финальных данных, чтобы далее сделать LoRA, а потом посчитать Weighted F1
:::

::: {.cell .code execution_count="33" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="siff1YHE5YS3" outputId="26670a3b-28ad-4e29-a97e-20de3a1409c6"}
``` python
from google.colab import drive
drive.mount('/content/drive')
```

::: {.output .stream .stdout}
    Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount("/content/drive", force_remount=True).
:::
:::

::: {.cell .code execution_count="34" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="VBHO5qU75fje" outputId="0a19ee6e-92bc-46ec-b74c-c78881dbe672"}
``` python
!pip install -q datasets peft evaluate
```

::: {.output .stream .stdout}
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 0.0/84.1 kB ? eta -:--:--
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 84.1/84.1 kB 8.4 MB/s eta 0:00:00
:::
:::

::: {.cell .code execution_count="35" id="3_IBUJ-Y5iuc"}
``` python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
from tqdm import tqdm
import torch
warnings.filterwarnings('ignore')
```
:::

::: {.cell .code execution_count="36" id="aRflb1oL5nmc"}
``` python
final_train = pd.read_csv('/content/drive/MyDrive/NLP_CASE_FINAL/FINAL_TRAIN.csv')
final_valid = pd.read_csv('/content/drive/MyDrive/NLP_CASE_FINAL/FINAL_VALID.csv')
final_test = pd.read_csv('/content/drive/MyDrive/NLP_CASE_FINAL/FINAL_TEST.csv')
```
:::

::: {.cell .code execution_count="37" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":304}" id="f1ypQRCWf17u" outputId="b8f13bd0-5ee6-4c0d-fd2b-54b992f40b11"}
``` python
final_train['pseudo_label_ensemble_final'] = final_train['pseudo_label_ensemble_final'].replace('unknown', 'текстиль')
final_train['pseudo_label_ensemble_final'].value_counts()
```

::: {.output .execute_result execution_count="37"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>pseudo_label_ensemble_final</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>одежда</th>
      <td>1197</td>
    </tr>
    <tr>
      <th>нет товара</th>
      <td>287</td>
    </tr>
    <tr>
      <th>текстиль</th>
      <td>194</td>
    </tr>
    <tr>
      <th>украшения и аксессуары</th>
      <td>9</td>
    </tr>
    <tr>
      <th>товары для детей</th>
      <td>4</td>
    </tr>
    <tr>
      <th>обувь</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label>
```
:::
:::

::: {.cell .code execution_count="38" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":562}" id="2Duzjr8B9Nug" outputId="7f66948e-55f3-49a9-b2ff-8e62a731e96d"}
``` python
final_valid = final_valid.rename(columns={'pseudo_label_rubert': 'pseudo_label_ensemble_final'})
train = pd.concat([final_train, final_valid])
del train['pseudo_label_rubert']
del train['confidence_rubert']
del train['pred_label']
del train['confidence']
del train['agree?']
del train['pseudo_label_final']
del train['Unnamed: 0']
del train['Unnamed: 0.1']
print(train['pseudo_label_ensemble_final'].value_counts())
train
```

::: {.output .stream .stdout}
    pseudo_label_ensemble_final
    одежда                    1273
    нет товара                 310
    текстиль                   202
    украшения и аксессуары      19
    товары для детей            12
    обувь                        2
    Name: count, dtype: int64
:::

::: {.output .execute_result execution_count="38"}
``` json
{"summary":"{\n  \"name\": \"train\",\n  \"rows\": 1818,\n  \"fields\": [\n    {\n      \"column\": \"text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 1818,\n        \"samples\": [\n          \"\\u041a \\u0441\\u043e\\u0436\\u0430\\u043b\\u0435\\u043d\\u0438\\u044e \\u0441\\u0438\\u043b\\u044c\\u043d\\u043e \\u0440\\u0430\\u0437\\u043e\\u0447\\u0430\\u0440\\u043e\\u0432\\u0430\\u043b\\u043e \\u043a\\u0430\\u0447\\u0435\\u0441\\u0442\\u0432\\u043e \\u043e\\u0442\\u0434\\u0435\\u043b\\u043a\\u0438. \\u0421\\u0430\\u043c\\u0430 \\u0442\\u043e\\u043b\\u0441\\u0442\\u043e\\u0432\\u043a\\u0430 \\u0445\\u043e\\u0440\\u043e\\u0448\\u0430\\u044f, \\u043d\\u043e \\u043c\\u0430\\u043d\\u0436\\u0435\\u0442\\u044b \\u0438 \\u0440\\u0435\\u0437\\u0438\\u043d\\u043a\\u0430 \\u0432 \\u043d\\u0438\\u0437\\u0443 - \\u043f\\u0440\\u043e\\u0441\\u0442\\u043e \\u0443\\u0436\\u0430\\u0441\\u043d\\u044b!\",\n          \"\\u043f\\u043b\\u0430\\u0442\\u044c\\u0435 \\u043e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e\\u0435 \\u0432 \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440 \\u043c\\u043d\\u0435 \\u043f\\u043e\\u043d\\u0440\\u0430\\u0432\\u0438\\u043b\\u043e\\u0441\\u044c\",\n          \"61 \\u0434\\u0435\\u043d\\u044c \\u0436\\u0434\\u0430\\u043b \\u0442\\u043e\\u0432\\u0430\\u0440, \\u0432\\u0435\\u0437\\u043b\\u0438 \\u043d\\u0430\\u0432\\u0435\\u0440\\u043d\\u043e \\u043d\\u0430 \\u0447\\u0435\\u0440\\u0435\\u043f\\u0430\\u0445\\u0430\\u0445.\\u0411\\u043e\\u043b\\u044c\\u0448\\u0435 \\u0437\\u0430\\u043a\\u0430\\u0437\\u044b\\u0432\\u0430\\u0442\\u044c \\u0442\\u0443\\u0442 \\u043d\\u0435 \\u0431\\u0443\\u0434\\u0443.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"pseudo_label_ensemble_final\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 6,\n        \"samples\": [\n          \"\\u043d\\u0435\\u0442 \\u0442\\u043e\\u0432\\u0430\\u0440\\u0430\",\n          \"\\u043e\\u0434\\u0435\\u0436\\u0434\\u0430\",\n          \"\\u043e\\u0431\\u0443\\u0432\\u044c\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}","type":"dataframe","variable_name":"train"}
```
:::
:::

::: {.cell .code execution_count="39" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="Uf0tiCAsZF_A" outputId="d80cfb91-b724-4ad3-c58c-b3801cf310bb"}
``` python
!pip install deep_translator

from deep_translator import GoogleTranslator
```

::: {.output .stream .stdout}
    Collecting deep_translator
      Downloading deep_translator-1.11.4-py3-none-any.whl.metadata (30 kB)
    Requirement already satisfied: beautifulsoup4<5.0.0,>=4.9.1 in /usr/local/lib/python3.12/dist-packages (from deep_translator) (4.13.5)
    Requirement already satisfied: requests<3.0.0,>=2.23.0 in /usr/local/lib/python3.12/dist-packages (from deep_translator) (2.32.4)
    Requirement already satisfied: soupsieve>1.2 in /usr/local/lib/python3.12/dist-packages (from beautifulsoup4<5.0.0,>=4.9.1->deep_translator) (2.8)
    Requirement already satisfied: typing-extensions>=4.0.0 in /usr/local/lib/python3.12/dist-packages (from beautifulsoup4<5.0.0,>=4.9.1->deep_translator) (4.15.0)
    Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.12/dist-packages (from requests<3.0.0,>=2.23.0->deep_translator) (3.4.3)
    Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.12/dist-packages (from requests<3.0.0,>=2.23.0->deep_translator) (3.10)
    Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests<3.0.0,>=2.23.0->deep_translator) (2.5.0)
    Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests<3.0.0,>=2.23.0->deep_translator) (2025.8.3)
    Downloading deep_translator-1.11.4-py3-none-any.whl (42 kB)
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 0.0/42.3 kB ? eta -:--:--
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 42.3/42.3 kB 4.3 MB/s eta 0:00:00
:::
:::

::: {.cell .code execution_count="40" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":476}" id="CjWaCZ6UbTvj" outputId="48d27399-05ab-4646-a3e8-e70fc8a5d8e9"}
``` python
import random
import time

def augment_text(text, variations=3):

    augmented_texts = []
    intermediate_languages = ['en', 'de', 'fr', 'es', 'it']

    for i in range(variations):
        try:

            intermediate_lang = random.choice(intermediate_languages)

            translated_intermediate = GoogleTranslator(
                source='ru',
                target=intermediate_lang
            ).translate(text)

            time.sleep(0.1)

            back_translated = GoogleTranslator(
                source=intermediate_lang,
                target='ru'
            ).translate(translated_intermediate)

            augmented_texts.append(back_translated)

            time.sleep(0.2)

        except Exception as e:
            print(f"Ошибка при аугментации: {e}")
            augmented_texts.append(text)

    return augmented_texts

rare_classes = ['украшения и аксессуары', 'товары для детей', 'обувь']
rare_class_samples = train[train['pseudo_label_ensemble_final'].isin(rare_classes)]

augmented_texts = []
augmented_labels = []

for _, row in tqdm(rare_class_samples.iterrows(), total=len(rare_class_samples)):
    text = row['text']
    label = row['pseudo_label_ensemble_final']

    augmented_variations = augment_text(text, variations=3)

    augmented_texts.extend(augmented_variations)
    augmented_labels.extend([label] * len(augmented_variations))

    time.sleep(0.5)

augmented_df = pd.DataFrame({
    'text': augmented_texts,
    'pseudo_label_ensemble_final': augmented_labels
})

augmented_df
```

::: {.output .stream .stderr}
    100%|██████████| 33/33 [03:39<00:00,  6.65s/it]
:::

::: {.output .execute_result execution_count="40"}
``` json
{"summary":"{\n  \"name\": \"augmented_df\",\n  \"rows\": 99,\n  \"fields\": [\n    {\n      \"column\": \"text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 72,\n        \"samples\": [\n          \"Good_x000d_\\n, \\u041c\\u043d\\u0435 \\u0432\\u0441\\u0435 \\u043f\\u043e\\u043d\\u0440\\u0430\\u0432\\u0438\\u043b\\u043e\\u0441\\u044c, \\u043d\\u043e \\u044f \\u0437\\u0430\\u043a\\u0430\\u0437\\u0430\\u043b \\u043c\\u043e\\u044e \\u0434\\u043e\\u0447\\u044c, \\u043e\\u043d\\u0430 \\u043e\\u043a\\u0430\\u0437\\u0430\\u043b\\u0430\\u0441\\u044c \\u0432\\u044b\\u0441\\u043e\\u043a\\u043e\\u0439 \\u043d\\u0430 \\u0441\\u0432\\u043e\\u0438\\u0445 \\u043f\\u043b\\u0435\\u0447\\u0430\\u0445. \\u041d\\u043e \\u044f \\u043f\\u0440\\u0438\\u0448\\u0435\\u043b \\u043a\\u043e \\u043c\\u043d\\u0435), \\u0441 SDK \\u0432\\u043e\\u0437\\u043d\\u0438\\u043a\\u043b\\u0430 \\u043f\\u0440\\u043e\\u0431\\u043b\\u0435\\u043c\\u0430, \\u043e\\u043d\\u0438 \\u043d\\u0435 \\u043c\\u043e\\u0433\\u043b\\u0438 \\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u0438\\u0442\\u044c \\u0435\\u0433\\u043e, \\u044f \\u0436\\u0434\\u0430\\u043b \\u043d\\u0435\\u0434\\u0435\\u043b\\u044e, \\u0438 \\u0432 \\u043a\\u043e\\u043d\\u0446\\u0435 \\u043a\\u043e\\u043d\\u0446\\u043e\\u0432 \\u044f \\u0441\\u0430\\u043c \\u0432\\u0437\\u044f\\u043b \\u044d\\u0442\\u043e.\",\n          \"\\u041a\\u0440\\u044b\\u0448\\u043a\\u0430 \\u0438\\u0437\\u043e\\u0433\\u043d\\u0443\\u0442\\u0430, \\u0441\\u0438\\u043d\\u0442\\u0435\\u0442\\u0438\\u0447\\u0435\\u0441\\u043a\\u0430\\u044f.\",\n          \"\\u0422\\u0435\\u043f\\u043b\\u044b\\u0439. \\u0414\\u043e\\u0441\\u0442\\u0430\\u0432\\u043a\\u0430 \\u0431\\u044b\\u0441\\u0442\\u0440\\u043e\\u0435. \\u042f \\u0440\\u0435\\u043a\\u043e\\u043c\\u0435\\u043d\\u0434\\u0443\\u044e.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"pseudo_label_ensemble_final\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3,\n        \"samples\": [\n          \"\\u0443\\u043a\\u0440\\u0430\\u0448\\u0435\\u043d\\u0438\\u044f \\u0438 \\u0430\\u043a\\u0441\\u0435\\u0441\\u0441\\u0443\\u0430\\u0440\\u044b\",\n          \"\\u0442\\u043e\\u0432\\u0430\\u0440\\u044b \\u0434\\u043b\\u044f \\u0434\\u0435\\u0442\\u0435\\u0439\",\n          \"\\u043e\\u0431\\u0443\\u0432\\u044c\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}","type":"dataframe","variable_name":"augmented_df"}
```
:::
:::

::: {.cell .code execution_count="41" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="BYWyBF6ocE71" outputId="3679a728-c5b9-459c-ed56-73535dcd9c47"}
``` python
train_df_augmented = pd.concat([train, augmented_df], ignore_index=True)
train_df_augmented.to_csv('train_split_augmented.csv', index=False)

print("Augmented class counts:", train_df_augmented['pseudo_label_ensemble_final'].value_counts())
```

::: {.output .stream .stdout}
    Augmented class counts: pseudo_label_ensemble_final
    одежда                    1273
    нет товара                 310
    текстиль                   202
    украшения и аксессуары      76
    товары для детей            48
    обувь                        8
    Name: count, dtype: int64
:::
:::

::: {.cell .code execution_count="42" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":424}" id="_KKuKxj0cbs1" outputId="8e2b9855-1265-48ca-e4fe-186b946c1858"}
``` python
train_df_augmented
```

::: {.output .execute_result execution_count="42"}
``` json
{"summary":"{\n  \"name\": \"train_df_augmented\",\n  \"rows\": 1917,\n  \"fields\": [\n    {\n      \"column\": \"text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 1890,\n        \"samples\": [\n          \"\\u041d\\u0435 \\u043f\\u0440\\u0438\\u0448\\u043b\\u0430 ! \\u042f \\u0432 \\u0440\\u0430\\u0441\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u0435 \\u043d\\u0435 \\u0437\\u0430\\u043a\\u0430\\u0437\\u044b\\u0432\\u0430\\u0439\\u0442\\u0435 \\u0441 \\u044d\\u0442\\u043e\\u0433\\u043e \\u043c\\u0430\\u0433\\u0430\\u0437\\u0438\\u043d\\u0430 \",\n          \"\\u042d\\u0442\\u043e \\u0448\\u0438\\u043a\\u0430\\u0440\\u043d\\u043e!! \\u041f\\u0440\\u0438\\u0448\\u043b\\u043e \\u0437\\u0430 2 \\u043d\\u0435\\u0434\\u0435\\u043b\\u0438 \\u0434\\u043e \\u0418\\u0440\\u043a\\u0443\\u0442\\u0441\\u043a\\u0430, \\u0437\\u0430\\u043f\\u0430\\u0445\\u0430 \\u043d\\u0435 \\u0431\\u044b\\u043b\\u043e, \\u0441\\u0442\\u0438\\u0440\\u043a\\u0438 \\u043f\\u0435\\u0440\\u0435\\u0436\\u0438\\u043b\\u0430 \\u0445\\u043e\\u0440\\u043e\\u0448\\u043e. \\u0411\\u043e\\u0436\\u0435,\\u044d\\u0442\\u043e \\u043f\\u043e\\u0442\\u0440\\u044f\\u0441\\u043d\\u043e!!! \\u0421\\u043f\\u0430\\u0441\\u0438\\u0431\\u043e \\u0431\\u043e\\u043b\\u044c\\u0448\\u043e\\u0435!))) \\u041e\\u0447\\u0435\\u043d\\u044c \\u0441\\u043e\\u0432\\u0435\\u0442\\u0443\\u044e)))))\",\n          \"\\u0441\\u043e\\u043e\\u0442\\u0432\\u0435\\u0442\\u0441\\u0442\\u0432\\u0443\\u0435\\u0442 \\u043e\\u043f\\u0438\\u0441\\u0430\\u043d\\u0438\\u044e, \\u043d\\u0435 \\u043c\\u043d\\u043e\\u0433\\u043e \\u043f\\u0440\\u043e\\u0441\\u0432\\u0435\\u0447\\u0438\\u0432\\u0430\\u0435\\u0442. \\u043d\\u0430 \\u0440\\u0430\\u0437\\u043c\\u0435\\u0440 50 \\u0431\\u0440\\u0430\\u043b\\u0430 \\u0445\\u0445\\u0445\\u043b \\u043a\\u0430\\u043a \\u0432 \\u043b\\u0438\\u0442\\u043e\\u0439, \\u043c\\u043e\\u0436\\u043d\\u043e \\u0438 \\u0431\\u043e\\u043b\\u044c\\u0448\\u0435. \\u0446\\u0432\\u0435\\u0442 \\u0441\\u0443\\u043f\\u0435\\u0440, \\u0441\\u043b\\u0430\\u0431\\u043e \\u043f\\u0440\\u0438\\u0448\\u0438\\u0442\\u044b \\u043f\\u0443\\u0433\\u043e\\u0432\\u0438\\u0446\\u044b \\u043f\\u0440\\u0438\\u0448\\u0438\\u0432\\u0430\\u043b\\u0438 \\u0441\\u043d\\u043e\\u0432\\u0430 \\u0442.\\u043a \\u043d\\u0430 \\u0440\\u0443\\u043a\\u0430\\u0432\\u0430\\u0445 \\u043f\\u043e\\u043e\\u0442\\u0440\\u044b\\u0432\\u0430\\u043b\\u0438\\u0441\\u044c \\u0441\\u0440\\u0430\\u0437\\u0443 \\u0435\\u0449\\u0451 \\u043d\\u0435 \\u043e\\u0434\\u0435\\u0432.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"pseudo_label_ensemble_final\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 6,\n        \"samples\": [\n          \"\\u043d\\u0435\\u0442 \\u0442\\u043e\\u0432\\u0430\\u0440\\u0430\",\n          \"\\u043e\\u0434\\u0435\\u0436\\u0434\\u0430\",\n          \"\\u043e\\u0431\\u0443\\u0432\\u044c\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}","type":"dataframe","variable_name":"train_df_augmented"}
```
:::
:::

::: {.cell .code execution_count="43" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="zmkldtYb_PSg" outputId="c0ca0032-0205-43f6-d9bd-666ebad2f5fb"}
``` python
from sklearn.model_selection import train_test_split

train_df, valid_df = train_test_split(
    train_df_augmented,
    test_size=0.2,
    stratify=train_df_augmented['pseudo_label_ensemble_final'],
    random_state=42
)

print(f"Train size: {len(train_df)}")
print(f"Validation size: {len(valid_df)}")
print("Train class distribution:\n", train_df['pseudo_label_ensemble_final'].value_counts(normalize=True))
print("Validation class distribution:\n", valid_df['pseudo_label_ensemble_final'].value_counts(normalize=True))
```

::: {.output .stream .stdout}
    Train size: 1533
    Validation size: 384
    Train class distribution:
     pseudo_label_ensemble_final
    одежда                    0.664057
    нет товара                0.161774
    текстиль                  0.105675
    украшения и аксессуары    0.039791
    товары для детей          0.024788
    обувь                     0.003914
    Name: proportion, dtype: float64
    Validation class distribution:
     pseudo_label_ensemble_final
    одежда                    0.664062
    нет товара                0.161458
    текстиль                  0.104167
    украшения и аксессуары    0.039062
    товары для детей          0.026042
    обувь                     0.005208
    Name: proportion, dtype: float64
:::
:::

::: {.cell .code execution_count="44" id="9AUkWHBkDVhP"}
``` python
train_df.to_csv('train_df_aug.csv')
valid_df.to_csv('valid_df_aug.csv')
```
:::

::: {.cell .markdown id="8ft7lYibC18z"}
# Делаем LoRA на аугментированных данных
:::

::: {.cell .code execution_count="45" id="7rWlm6b3DDiz"}
``` python
from transformers import AutoModelForSequenceClassification, AutoTokenizer, Trainer, TrainingArguments
from peft import LoraConfig, get_peft_model
from datasets import load_dataset
from sklearn.metrics import f1_score
from sklearn.utils.class_weight import compute_class_weight
from sklearn.preprocessing import LabelEncoder
```
:::

::: {.cell .code execution_count="46" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":273,\"referenced_widgets\":[\"b4c8eb474dac4de1be418b2cf305247c\",\"b0df3706a8924d18ab00ae6273c99395\",\"bf986cb679b14715b18f6d74b5d55716\",\"f96be65a21c7452f803e9ef4e991365a\",\"d1db3f9b00814b4fb4dedea15806a456\",\"8d98847c315b469199170896a9437c80\",\"6102dd02e1dd44588c0c11547060c808\",\"6e1ba3f2f338463a826899d1e2ca5f25\",\"a13d4eb395f9463b98f498d1783af52a\",\"95095f93c5f749638f99da42b033fe8c\",\"8dad3753b0c748ad9bbdbb24e98850d2\",\"2586a33ed6ed42dc84d9af4a07efb276\",\"043c8a5b36644ed989b61aaee03794b9\",\"6bef76c6ee614a66bdfbac9405125638\",\"5b4754e60dfd41a696046111c1bee5e9\",\"2d25ec8493dc4aec844bc89397950b18\",\"9ecac5858dca4d99abc090bf6fc76800\",\"ce590e850b2b4771b716039ec731b853\",\"4037ec13dfdd431eb11dbca223aff328\",\"9c3010ea047946d5a49e11de7bdc9e14\",\"86808e1cd4414eafa04015620b6e22ba\",\"95a6970d52bc4e0286a4ba73d692c932\",\"dd4f5d39f7c243bc882d55a9cecbb8a5\",\"e4ec9554b90842a5b8b543bdb19de199\",\"61e7211162bc4ee6ae3323fa3283a2cf\",\"d77c3e68f8eb40c29b353dd6f1232def\",\"c3f920583d5b411bb2d1f0084218628c\",\"54ccee04dbd54f97a8e14db0c278bae4\",\"8790f72102f54bc6a9a818d1df7f8b62\",\"95a695d77ff443c4abb48da51b80b8e0\",\"95d8fa589c394aefa3d72f9c99e97a11\",\"9f92fd8be3c241329e4aaaa4ecbe7ec9\",\"69cb8250c15240b988e5f8620befec9c\",\"94f24db4f57541b596ec6a6b66729466\",\"c222879b824140478d10b39b22081e48\",\"0f9cef7c697d487c82d5ed2d57c08432\",\"d7160671464b4c8bbc44bb815191411e\",\"cf1034607318491288fa59b0156d4ce8\",\"61cc6d8dc1444cdd94f860a634d42b0f\",\"5a7128746e6c483d95c3b74bf22ab256\",\"6a37b354666a4548a09a6cacad71b52e\",\"3c952e7619f34e59b4cf1b016fb7fd9e\",\"325b31c39ea04cb89029eacecf34a292\",\"0315765bb52e4924a9be49d4e44d367d\",\"30e00814a02b4418ae7aac4960d34509\",\"66ddd19fcece46459c58667cb1540204\",\"94952db942a54178ae7b88f09d8d1c10\",\"49f4efcde807498a8bbb3797936e7c0d\",\"3165f71df4e8452a84591587650a3372\",\"ddf3375caf174517be0f0efeb3b3b4be\",\"373c76c943f34c5daae5ec45f87b1f39\",\"618f92d640c444bda57c245643bc8bc1\",\"096a2cc9ea7c4f7b805e6fa209c800b8\",\"efaa953e70b64ae4b8913317652d7389\",\"7be483ea98b14adc944e56fab77f0ee2\",\"321803dfc6364afc92cab88e6d0e7480\",\"c20a1dbaf9f1451aa2539a26df64373b\",\"fe0e5d0ef991465582bc725ad035f8f1\",\"833463f14ae74e41a31d2d28490b5a13\",\"699ddf13358c479a8bd358b0dbec4960\",\"3028075e6f764595be88041e0c57be5e\",\"0d10bfc6078547f580a8d078ec69f817\",\"3deb824fdd1b4cc1b08558fd59dcead6\",\"01e7d116e0ea4283b3207b2f71da1f7c\",\"f58f553680e84b479e7a0acf59a61003\",\"63c7fa8a5f4c45689066cc335acf4df0\",\"f39890f25b4647e6b20538e409c8facd\",\"2ece6ea27e904cf3b9c9ecdb2e827941\",\"2faae4a71f164b2f8d3221e7031f7c5d\",\"cc6d105c60814a55b30275500849812f\",\"5954646402594b57b5d6992714193451\",\"3eecbd4f17ed4241b4dcd6812171ce4a\",\"56adc9cf06db4e019b3b2f98610b507b\",\"98dc91397b5a4e06ac54539ace5d6008\",\"15d76178b9ae41f2845f4c321a661f71\",\"95d59470f19a41e49c48fecca45b1f48\",\"d200360e02c7415dade052b589dde182\",\"63a59279bba24361a41f5ba8d467e585\",\"a15e986b23f547c1bb6579c4b63f00f7\",\"36f8f78cf4c24d61ae3c7a98ed015fdb\",\"25e5974b6216436fb8b3bfde2d9847b2\",\"b4978e26b4654b55a011d5fa1282d16b\",\"22ccf54fea804197bcecc1e1ebcfac24\",\"d0084180a51f44e9ba7432ae36226329\",\"974866637b004005a6194fe5ad4b601a\",\"96a3f0195b4e4a9d96fa317be22c218e\",\"ac43528ff7d043df93e3a528ad346935\",\"cade815c501d472980533c05e09f444e\"]}" id="auS9S1mKDLiv" outputId="24f8992d-44cf-498b-a65f-b89c4ce67c09"}
``` python
dataset = load_dataset('csv', data_files={'train': '/content/train_df_aug.csv', 'validation': '/content/valid_df_aug.csv'})
tokenizer = AutoTokenizer.from_pretrained('DeepPavlov/rubert-base-cased')

label_encoder = LabelEncoder()
train_labels = label_encoder.fit_transform(dataset['train']['pseudo_label_ensemble_final'])
import pickle
with open('label_encoder.pkl', 'wb') as f:
    pickle.dump(label_encoder, f)
valid_labels = label_encoder.transform(dataset['validation']['pseudo_label_ensemble_final'])

dataset['train'] = dataset['train'].add_column('label', train_labels)
dataset['validation'] = dataset['validation'].add_column('label', valid_labels)

def tokenize_function(examples):
    return tokenizer(examples['text'], padding='max_length', truncation=True, max_length=512)

tokenized_datasets = dataset.map(tokenize_function, batched=True)
tokenized_datasets = tokenized_datasets.remove_columns(['text', 'pseudo_label_ensemble_final'])
tokenized_datasets = tokenized_datasets.rename_column('label', 'labels')

classes = np.array(train_labels)
class_weights = compute_class_weight('balanced', classes=np.unique(classes), y=classes)
class_weights = torch.tensor(class_weights, dtype=torch.float).to('cuda')
```

::: {.output .display_data}
``` json
{"model_id":"b4c8eb474dac4de1be418b2cf305247c","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"2586a33ed6ed42dc84d9af4a07efb276","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"dd4f5d39f7c243bc882d55a9cecbb8a5","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"94f24db4f57541b596ec6a6b66729466","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"30e00814a02b4418ae7aac4960d34509","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"321803dfc6364afc92cab88e6d0e7480","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"f39890f25b4647e6b20538e409c8facd","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"63a59279bba24361a41f5ba8d467e585","version_major":2,"version_minor":0}
```
:::
:::

::: {.cell .code execution_count="47" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="2Q1SED3eV2GH" outputId="36dc9dc7-ba51-4056-fe95-973b4b20e865"}
``` python
from collections import Counter
print(Counter(valid_labels))
print(Counter(train_labels))
```

::: {.output .stream .stdout}
    Counter({np.int64(2): 255, np.int64(0): 62, np.int64(3): 40, np.int64(5): 15, np.int64(4): 10, np.int64(1): 2})
    Counter({np.int64(2): 1018, np.int64(0): 248, np.int64(3): 162, np.int64(5): 61, np.int64(4): 38, np.int64(1): 6})
:::
:::

::: {.cell .code execution_count="48" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":84,\"referenced_widgets\":[\"f991de4987c442b1b541eec3971948af\",\"1bad8e754f0b4f039cbe976ed5b3b66a\",\"8ceee63ec20144349a805c55bf1bd92c\",\"9ef15be7cdf64e279a958579dbeb6683\",\"86ee77b3779d473abe168c570612fd35\",\"b128d973246947899a8a15c118cd7b29\",\"612f4d893d294e249309eb4142958b44\",\"af5fe5fd6cf04f5bbb73c1abe7d90c6b\",\"47124271b3cd4450beed89f89613d87f\",\"63b6762fa4844883939466cc387d9577\",\"69bf04f2ba7144618eb948f35dde63a9\"]}" id="jbsvHi9pDvsG" outputId="d1a09275-43ab-4fc3-cc66-9305bebfbc9b"}
``` python
model = AutoModelForSequenceClassification.from_pretrained(
    'DeepPavlov/rubert-base-cased',
    num_labels=6,
    device_map='cuda'
)
lora_config = LoraConfig(
    r=32,
    lora_alpha=16,
    target_modules=['query', 'value'],
    lora_dropout=0.4,
    bias='none',
    task_type='SEQ_CLS'
)
model = get_peft_model(model, lora_config)
```

::: {.output .display_data}
``` json
{"model_id":"f991de4987c442b1b541eec3971948af","version_major":2,"version_minor":0}
```
:::

::: {.output .stream .stderr}
    Some weights of BertForSequenceClassification were not initialized from the model checkpoint at DeepPavlov/rubert-base-cased and are newly initialized: ['classifier.bias', 'classifier.weight']
    You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
:::
:::

::: {.cell .code execution_count="49" id="8Wa33uWFD4ph"}
``` python
class CustomTrainer(Trainer):
    def compute_loss(self, model, inputs, return_outputs=False, num_items_in_batch=None):
        labels = inputs.pop('labels')
        outputs = model(**inputs)
        logits = outputs.logits
        loss_fct = torch.nn.CrossEntropyLoss(weight=class_weights)
        loss = loss_fct(logits, labels)
        return (loss, outputs) if return_outputs else loss
```
:::

::: {.cell .code execution_count="50" id="zvNjdfg8D8Nw"}
``` python
def compute_metrics(eval_pred):
    logits, labels = eval_pred
    predictions = np.argmax(logits, axis=-1)
    weighted_f1 = f1_score(labels, predictions, average='weighted')
    per_class_f1 = f1_score(labels, predictions, average=None)
    class_names = label_encoder.classes_
    for cls, f1 in zip(class_names, per_class_f1):
        print(f"Class {cls}: F1 = {f1}")
        with open('metrics.txt', 'a') as f:
            f.write(f"Epoch {trainer.state.epoch}: Class {cls}: F1 = {f1}\n")
    with open('metrics.txt', 'a') as f:
        f.write(f"Epoch {trainer.state.epoch}: Weighted F1 = {weighted_f1}\n")
    print(f"Epoch {trainer.state.epoch}: Weighted F1 = {weighted_f1}")
    return {'weighted_f1': weighted_f1}
```
:::

::: {.cell .code execution_count="55" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="xMbK3eN1D-GQ" outputId="6ed39770-9272-42a5-a89d-36292c5910e7"}
``` python
#полетели
training_args = TrainingArguments(
    output_dir='./results_lora_1',
    num_train_epochs=20,
    per_device_train_batch_size=16,
    per_device_eval_batch_size=16,
    eval_strategy='epoch',
    save_strategy='epoch',
    load_best_model_at_end=True,
    metric_for_best_model='eval_loss',
    greater_is_better=False,
    learning_rate=1e-4,
    weight_decay=0.01,
    logging_dir='./logs',
    logging_steps=10,
    fp16=True,
    seed=42
)

trainer = CustomTrainer(
    model=model,
    args=training_args,
    train_dataset=tokenized_datasets['train'],
    eval_dataset=tokenized_datasets['validation'],
    compute_metrics=compute_metrics
)
```

::: {.output .stream .stderr}
    Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
:::
:::

::: {.cell .code execution_count="56" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":1000}" collapsed="true" id="fHG22FdYECh3" outputId="ad2a87d8-4e40-4f6f-b2a4-22e76ca0b0cf"}
``` python
import os
os.environ["WANDB_DISABLED"] = "true"
import wandb
wandb.init(mode="disabled")
trainer.train()
```

::: {.output .display_data}
```{=html}

    <div>
      
      <progress value='1920' max='1920' style='width:300px; height:20px; vertical-align: middle;'></progress>
      [1920/1920 11:55, Epoch 20/20]
    </div>
    <table border="1" class="dataframe">
  <thead>
 <tr style="text-align: left;">
      <th>Epoch</th>
      <th>Training Loss</th>
      <th>Validation Loss</th>
      <th>Weighted F1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>1.467800</td>
      <td>1.471222</td>
      <td>0.356103</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.464300</td>
      <td>1.273413</td>
      <td>0.596468</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.347400</td>
      <td>1.175215</td>
      <td>0.467373</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.231400</td>
      <td>1.072837</td>
      <td>0.421932</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.982600</td>
      <td>1.023092</td>
      <td>0.605811</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.694700</td>
      <td>1.027451</td>
      <td>0.606877</td>
    </tr>
    <tr>
      <td>7</td>
      <td>1.054900</td>
      <td>0.963761</td>
      <td>0.545723</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.747800</td>
      <td>0.928305</td>
      <td>0.534736</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.579200</td>
      <td>0.894945</td>
      <td>0.618685</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.603400</td>
      <td>0.912372</td>
      <td>0.587874</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.729700</td>
      <td>0.841614</td>
      <td>0.648832</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.787800</td>
      <td>0.831997</td>
      <td>0.632225</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.729700</td>
      <td>0.825975</td>
      <td>0.656930</td>
    </tr>
    <tr>
      <td>14</td>
      <td>1.009700</td>
      <td>0.804362</td>
      <td>0.655159</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.496900</td>
      <td>0.786624</td>
      <td>0.699818</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.621200</td>
      <td>0.772071</td>
      <td>0.672807</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.552600</td>
      <td>0.764945</td>
      <td>0.708065</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.468200</td>
      <td>0.786846</td>
      <td>0.645798</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.518100</td>
      <td>0.765949</td>
      <td>0.691259</td>
    </tr>
    <tr>
      <td>20</td>
      <td>0.504000</td>
      <td>0.766751</td>
      <td>0.692564</td>
    </tr>
  </tbody>
</table><p>
```
:::

::: {.output .stream .stdout}
    Class нет товара: F1 = 0.6091954022988506
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.34055727554179566
    Class текстиль: F1 = 0.30327868852459017
    Class товары для детей: F1 = 0.0
    Class украшения и аксессуары: F1 = 0.0
    Epoch 1.0: Weighted F1 = 0.3561025201736204
    Class нет товара: F1 = 0.6585365853658537
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.6725274725274726
    Class текстиль: F1 = 0.2641509433962264
    Class товары для детей: F1 = 0.6153846153846154
    Class украшения и аксессуары: F1 = 0.0
    Epoch 2.0: Weighted F1 = 0.5964678585335511
    Class нет товара: F1 = 0.6753246753246753
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.46153846153846156
    Class текстиль: F1 = 0.3238095238095238
    Class товары для детей: F1 = 0.6956521739130435
    Class украшения и аксессуары: F1 = 0.0
    Epoch 3.0: Weighted F1 = 0.46737328191132543
    Class нет товара: F1 = 0.6709677419354839
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.3857566765578635
    Class текстиль: F1 = 0.32407407407407407
    Class товары для детей: F1 = 0.5
    Class украшения и аксессуары: F1 = 0.2727272727272727
    Epoch 4.0: Weighted F1 = 0.4219318348336647
    Class нет товара: F1 = 0.6933333333333334
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.6619385342789598
    Class текстиль: F1 = 0.40875912408759124
    Class товары для детей: F1 = 0.45
    Class украшения и аксессуары: F1 = 0.0
    Epoch 5.0: Weighted F1 = 0.605810827789857
    Class нет товара: F1 = 0.7172413793103448
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.642512077294686
    Class текстиль: F1 = 0.3668639053254438
    Class товары для детей: F1 = 0.8181818181818182
    Class украшения и аксессуары: F1 = 0.125
    Epoch 6.0: Weighted F1 = 0.6068773948495371
    Class нет товара: F1 = 0.6585365853658537
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.5801526717557252
    Class текстиль: F1 = 0.39473684210526316
    Class товары для детей: F1 = 0.5
    Class украшения и аксессуары: F1 = 0.0
    Epoch 7.0: Weighted F1 = 0.5457231074859462
    Class нет товара: F1 = 0.7114093959731543
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.5421052631578948
    Class текстиль: F1 = 0.3492063492063492
    Class товары для детей: F1 = 0.782608695652174
    Class украшения и аксессуары: F1 = 0.08
    Epoch 8.0: Weighted F1 = 0.5347358478655585
    Class нет товара: F1 = 0.7114093959731543
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.655421686746988
    Class текстиль: F1 = 0.425531914893617
    Class товары для детей: F1 = 0.6666666666666666
    Class украшения и аксессуары: F1 = 0.17647058823529413
    Epoch 9.0: Weighted F1 = 0.6186846738457246
    Class нет товара: F1 = 0.7591240875912408
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.5954198473282443
    Class текстиль: F1 = 0.3756906077348066
    Class товары для детей: F1 = 0.8181818181818182
    Class украшения и аксессуары: F1 = 0.24242424242424243
    Epoch 10.0: Weighted F1 = 0.5878738557993054
    Class нет товара: F1 = 0.7210884353741497
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.6855791962174941
    Class текстиль: F1 = 0.45112781954887216
    Class товары для детей: F1 = 0.782608695652174
    Class украшения и аксессуары: F1 = 0.25
    Epoch 11.0: Weighted F1 = 0.6488317129352471
    Class нет товара: F1 = 0.726027397260274
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.6585365853658537
    Class текстиль: F1 = 0.47761194029850745
    Class товары для детей: F1 = 0.72
    Class украшения и аксессуары: F1 = 0.23529411764705882
    Epoch 12.0: Weighted F1 = 0.6322250449871767
    Class нет товара: F1 = 0.7464788732394366
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.6888361045130641
    Class текстиль: F1 = 0.4583333333333333
    Class товары для детей: F1 = 0.782608695652174
    Class украшения и аксессуары: F1 = 0.2777777777777778
    Epoch 13.0: Weighted F1 = 0.6569296451775993
    Class нет товара: F1 = 0.762589928057554
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.6842105263157895
    Class текстиль: F1 = 0.4647887323943662
    Class товары для детей: F1 = 0.782608695652174
    Class украшения и аксессуары: F1 = 0.22727272727272727
    Epoch 14.0: Weighted F1 = 0.6551588200819843
    Class нет товара: F1 = 0.7310344827586207
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.7397260273972602
    Class текстиль: F1 = 0.584070796460177
    Class товары для детей: F1 = 0.75
    Class украшения и аксессуары: F1 = 0.2608695652173913
    Epoch 15.0: Weighted F1 = 0.6998180996198017
    Class нет товара: F1 = 0.7310344827586207
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.7047619047619048
    Class текстиль: F1 = 0.5196850393700787
    Class товары для детей: F1 = 0.782608695652174
    Class украшения и аксессуары: F1 = 0.3137254901960784
    Epoch 16.0: Weighted F1 = 0.6728067565874642
    Class нет товара: F1 = 0.7114093959731543
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.7459954233409611
    Class текстиль: F1 = 0.616822429906542
    Class товары для детей: F1 = 0.8181818181818182
    Class украшения и аксессуары: F1 = 0.3137254901960784
    Epoch 17.0: Weighted F1 = 0.7080646177950564
    Class нет товара: F1 = 0.7571428571428571
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.6699029126213593
    Class текстиль: F1 = 0.45517241379310347
    Class товары для детей: F1 = 0.8181818181818182
    Class украшения и аксессуары: F1 = 0.2553191489361702
    Epoch 18.0: Weighted F1 = 0.6457984422627309
    Class нет товара: F1 = 0.7310344827586207
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.7255813953488373
    Class текстиль: F1 = 0.5641025641025641
    Class товары для детей: F1 = 0.782608695652174
    Class украшения и аксессуары: F1 = 0.3137254901960784
    Epoch 19.0: Weighted F1 = 0.6912590250483163
    Class нет товара: F1 = 0.7412587412587412
    Class обувь: F1 = 0.0
    Class одежда: F1 = 0.7272727272727273
    Class текстиль: F1 = 0.55
    Class товары для детей: F1 = 0.782608695652174
    Class украшения и аксессуары: F1 = 0.3137254901960784
    Epoch 20.0: Weighted F1 = 0.6925639497970061
:::

::: {.output .execute_result execution_count="56"}
    TrainOutput(global_step=1920, training_loss=0.8210218794643879, metrics={'train_runtime': 715.6527, 'train_samples_per_second': 42.842, 'train_steps_per_second': 2.683, 'total_flos': 8178817378959360.0, 'train_loss': 0.8210218794643879, 'epoch': 20.0})
:::
:::

::: {.cell .code execution_count="54" id="4rhjqF3WK7-s"}
``` python
#!rm -rf ./results_lora_1
#!rm -rf /content/best_model
#!rm -f metrics.txt misclassified.txt
```
:::

::: {.cell .code execution_count="57" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="wzdcF2VFz67o" outputId="73365a97-b958-4883-bba4-7eb48d5173e0"}
``` python
!ls ./results_lora_1
```

::: {.output .stream .stdout}
    checkpoint-1056  checkpoint-1536  checkpoint-1920  checkpoint-672
    checkpoint-1152  checkpoint-1632  checkpoint-288   checkpoint-768
    checkpoint-1248  checkpoint-1728  checkpoint-384   checkpoint-864
    checkpoint-1344  checkpoint-1824  checkpoint-480   checkpoint-96
    checkpoint-1440  checkpoint-192   checkpoint-576   checkpoint-960
:::
:::

::: {.cell .markdown id="vzVJSLpl_iNk"}
# Предобученную RuBERT прогоняем через test, чтобы получить предсказания
:::

::: {.cell .code execution_count="58" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":84,\"referenced_widgets\":[\"fe2423fdc49442c29976f8f427ead72a\",\"804ecde7592c4e66aff386cd4953effa\",\"87dd6e8be8324f8293676d77fe4a0b9e\",\"dd2bb23176994fd9a9ef5521d9711f05\",\"46fe6550d4ce4bf5b8cbaa59443749c5\",\"4ed77ead4c984f82b61c4352311789f7\",\"fcbac45cfaf84ad4b016dfabe19a5c17\",\"7700a527a2964106b8c3eb26eb3c37e9\",\"f18313a2fa384e109c5ea1d869c050e5\",\"f5ae284c066b448a9edeab803fce132a\",\"d5a28cfa691d4053972e34dc383a1edc\"]}" id="cNX0-49tpA7A" outputId="7b486d45-5d56-457f-ddd4-b57500002794"}
``` python
from peft import PeftModel

tokenizer = AutoTokenizer.from_pretrained('DeepPavlov/rubert-base-cased')

checkpoint_path = '/content/results_lora_1/checkpoint-1632'
model = AutoModelForSequenceClassification.from_pretrained(
    'DeepPavlov/rubert-base-cased',
    num_labels=6
)
model = PeftModel.from_pretrained(model, checkpoint_path)
model = model.to('cuda')

with open('label_encoder.pkl', 'rb') as f:
    label_encoder = pickle.load(f)

test_df = pd.read_csv('/content/drive/MyDrive/NLP_CASE_FINAL/FINAL_TEST.csv')
test_dataset = load_dataset('csv', data_files={'test': '/content/drive/MyDrive/NLP_CASE_FINAL/FINAL_TEST.csv'})
```

::: {.output .stream .stderr}
    Some weights of BertForSequenceClassification were not initialized from the model checkpoint at DeepPavlov/rubert-base-cased and are newly initialized: ['classifier.bias', 'classifier.weight']
    You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
:::

::: {.output .display_data}
``` json
{"model_id":"fe2423fdc49442c29976f8f427ead72a","version_major":2,"version_minor":0}
```
:::
:::

::: {.cell .code execution_count="59" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":223,\"referenced_widgets\":[\"2e6b484ce9474b188daeb2724724a00f\",\"80f5e32430434d8da997d9d883e956d4\",\"2433c81a283f4d5991d895678eb4aed2\",\"af245cff633249f0a4d4b711df220205\",\"2b5845514d954a3383aee467a05cfa1d\",\"82e7ddfd97124947bdb1d4dfd911e6e6\",\"d59529585d6a4990989a2d22e687822c\",\"9a0666df5d5746b1a7a3087bdde74fec\",\"a4871ff125884d079879ff6bbac9d67e\",\"d4bf375839b34352904c9a6bd1064fa4\",\"0020cc28ae584c33b30279db6d93e3ac\"]}" id="p8rn8pPAu3_5" outputId="4459fde7-228f-4696-91d1-bab54f2aae39"}
``` python
def tokenize_function(examples):
    return tokenizer(examples['text'], padding='max_length', truncation=True, max_length=512)

tokenized_test = test_dataset['test'].map(tokenize_function, batched=True)
tokenized_test = tokenized_test.remove_columns(['text'])

model.eval()
predictions = []
start_time = time.time()

for i in tqdm(range(0, len(tokenized_test), 16)):
    batch = tokenized_test[i:i+16]
    inputs = {
        'input_ids': torch.tensor(batch['input_ids']).to('cuda'),
        'attention_mask': torch.tensor(batch['attention_mask']).to('cuda')
    }
    with torch.no_grad():
        outputs = model(**inputs)
    logits = outputs.logits
    batch_preds = torch.argmax(logits, dim=-1).cpu().numpy()
    predictions.extend(batch_preds)

elapsed_time = time.time() - start_time
avg_time_per_example = elapsed_time / len(test_df)
print(f"Average inference time per example: {avg_time_per_example:.3f} seconds")

predictions = label_encoder.inverse_transform(predictions)
predictions = ['текстиль' if pred == 'обувь' else pred for pred in predictions]

ground_truth = test_df['pseudo_label_ensemble_final'].values
weighted_f1 = f1_score(ground_truth, predictions, average='weighted')
per_class_f1 = f1_score(ground_truth, predictions, average=None)
class_names = sorted(test_df['pseudo_label_ensemble_final'].unique())
for cls, f1 in zip(class_names, per_class_f1):
    print(f"Class {cls}: F1 = {f1}")
print(f"Weighted F1-score on test set: {weighted_f1}")

test_df['predicted_label'] = predictions
test_df[['Unnamed: 0', 'text', 'pseudo_label_ensemble_final', 'predicted_label']].to_csv('test_predictions.csv', index=False)
with open('test_metrics.txt', 'w') as f:
    for cls, f1 in zip(class_names, per_class_f1):
        f.write(f"Class {cls}: F1 = {f1}\n")
    f.write(f"Weighted F1-score on test set: {weighted_f1}\n")
print("Predictions saved to test_predictions.csv")
print("Metrics saved to test_metrics.txt")
```

::: {.output .display_data}
``` json
{"model_id":"2e6b484ce9474b188daeb2724724a00f","version_major":2,"version_minor":0}
```
:::

::: {.output .stream .stderr}
    100%|██████████| 455/455 [03:42<00:00,  2.05it/s]
:::

::: {.output .stream .stdout}
    Average inference time per example: 0.031 seconds
    Class нет товара: F1 = 0.6873457878040183
    Class одежда: F1 = 0.7052620696784865
    Class текстиль: F1 = 0.005702066999287242
    Class товары для детей: F1 = 0.027777777777777776
    Class украшения и аксессуары: F1 = 0.01763668430335097
    Weighted F1-score on test set: 0.6983976359503813
    Predictions saved to test_predictions.csv
    Metrics saved to test_metrics.txt
:::

::: {.output .stream .stderr}
:::
:::

::: {.cell .code execution_count="60" id="7nZ-2ezWseb8"}
``` python
a = pd.read_csv('test_predictions.csv')
a = a['predicted_label']
a.name = 'category'
a.to_csv('final_submission_all.csv')
```
:::
