# reviews-classification

Classification of product reviews using RuBERT, XLM-RoBERTa, CatBoost, and LoRA, including data augmentation with back translation, to improve performance on minor classes.

## Общая архитектура решения

![Общая схема работы](/images/photo_2025-09-17_23-55-04.jpg)
*Рис. 1: Мыслительный роадмап решений и итеративный процесс разметки*

## Итеративный процесс разметки данных

### Этап 0: Начальное разделение
- Изначальный train разделен на **train_df (1717 samples)** и **val_df (100 samples)**
- Val_df размечен вручную для валидации

### Этап 1: Эксперименты с LLM (отвергнуто)
- **Попытка 1**: Llama2 7B - не помещается в память Google Colab ❌
- **Попытка 2**: Flan-T5-large - ответы оторваны от реальности ❌  
- **Попытка 3**: Helsinki-NLP/opus-mt-ru-en + Flan-T5-large (zero-shot) - плохая семантика ❌

### Этап 2: Первые рабочие подходы
- **Попытка 4**: Helsinki-NLP/opus-mt-ru-en → Flan-T5-base эмбеддинги → CatBoost
  - **Результат**: 70% accuracy на 50 случайных примерах
  - **Проблема**: потеря семантической информации при переводе

### Этап 3: Прорыв с русскими эмбеддингами
- **Попытка 5**: Эмбеддинги на DeepPavlov/rubert-base-cased ИЛИ ai-forever/sbert_large_nlu_ru → CatBoost
  - **Результат**: 70-80% accuracy на 50 случайных примерах ✅
  - **Выявленная проблема**: В valid не хватает классов:
    - "обувь", "текстиль", "товары для детей"
    - "украшения и аксессуары", "электроника"
    - "бытовая техника", "посуда"

### Этап 4: Активное дообучение и ансамбль
**Методология RuBERT + CatBoost с итеративной разметкой:**

1. **Первоначальное обучение** на val_df
2. **Ручная разметка** части train (десятки неразмеченных объектов)
3. **Тестирование** на train с выявлением сложных случаев
4. **Дополнительная ручная разметка** проблемных примеров
5. **Валидация с XLM-RoBERTa** (joeddav/xlm-roberta-large-xnli):
   - Сравнение расхождений между нашей моделью и zero-shot классификатором
   - Ручная коррекция спорных случаев

6. **Ансамблевый алгоритм** (реализован в finalfinalfinal_all.csv):
   - Комбинирование предсказаний нескольких моделей
   - Разрешение конфликтов через правила и ручную проверку
   - Фильтрация unknowns
